<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0">
    <title>Kadraj l'Atelier</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged, signInAnonymously } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
        import { getFirestore, doc, setDoc, getDoc, collection, getDocs, updateDoc, arrayUnion, arrayRemove, query, where } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCqrcT7QY6tsYJidztDDu2BZhU7hLZF-ZE",
            authDomain: "kadrajatelier-7e02a.firebaseapp.com",
            projectId: "kadrajatelier-7e02a",
            storageBucket: "kadrajatelier-7e02a.firebasestorage.app",
            messagingSenderId: "4259035875263",
            appId: "1:4259035875263:web:d1002c3816e86b4be52a0a"
        };
        
        const app = initializeApp(firebaseConfig);
        
        const auth = getAuth(app);
        const db = getFirestore(app);
        window.firebaseApp = app;
        window.firebaseAuth = auth;
        window.firebaseFirestore = db;
        window.createUserWithEmailAndPassword = createUserWithEmailAndPassword;
        window.signInWithEmailAndPassword = signInWithEmailAndPassword;
        window.signOut = signOut;
        window.onAuthStateChanged = onAuthStateChanged;
        window.signInAnonymously = signInAnonymously;
        window.doc = doc;
        window.setDoc = setDoc;
        window.getDoc = getDoc;
        window.collection = collection;
        window.getDocs = getDocs;
        window.updateDoc = updateDoc;
        window.arrayUnion = arrayUnion;
        window.arrayRemove = arrayRemove;
        window.query = query;
        window.where = where;
        window.updateDoc = updateDoc;
        window.arrayUnion = arrayUnion;
        window.arrayRemove = arrayRemove;
        window.query = query;
        window.where = where;

    </script>

    <style>
        @keyframes scroll-left {
            0% { transform: translateX(0%); }
            100% { transform: translateX(-100%); }
        }
        .animate-scroll { animation: scroll-left 40s linear infinite; }
        .animate-scroll:hover { animation-play-state: paused; }
        .aspect-w-16 { position: relative; width: 100%; padding-bottom: 56.25%; }
        .aspect-h-9 { position: relative; width: 100%; padding-bottom: 56.25%; }
        .md\:aspect-w-1 { padding-bottom: 100%; }
        .md\:aspect-h-1 { padding-bottom: 100%; }
        .aspect-w-16 > *, .aspect-h-9 > *, .md\:aspect-w-1 > *, .md\:aspect-h-1 > * { position: absolute; height: 100%; width: 100%; top: 0; left: 0; }
        @keyframes slide {
            0%, 30% { transform: translateX(0%); }
            33%, 63% { transform: translateX(-33.33%); }
            66%, 96% { transform: translateX(-66.66%); }
            100% { transform: translateX(0%); }
        }
        .image-slider {
            animation: slide 21s infinite;
        }
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        .font-serif-new-roman {
            font-family: 'Times New Roman', serif;
        }

        @keyframes fade-in-down {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .animate-fade-in-down {
            animation: fade-in-down 0.3s ease-in-out forwards;
        }
        
        .prose ul { list-style-type: disc; padding-left: 1.5rem; }
        .prose li { margin-bottom: 0.5rem; }

        @media (max-width: 767px) {
            .mobile-grid-2 {
                grid-template-columns: repeat(2, minmax(0, 1fr));
            }
            .mobile-grid-3 {
                grid-template-columns: repeat(3, minmax(0, 1fr));
            }
            .flex-mobile-col {
                flex-direction: column;
            }
        }
    </style>

<style>
/* Soft filled heart when user has favorites */
.fav-indicator-on svg { fill: rgba(239,68,68,0.15); stroke: #ef4444; }

/* Added animations */
@keyframes pop-in { 0%{ transform: scale(0.9); opacity: .6;} 60%{ transform: scale(1.04); opacity: 1;} 100%{ transform: scale(1); } }
@keyframes pulse-ring { 0%{ box-shadow: 0 0 0 0 rgba(0,0,0,0.08);} 70% { box-shadow: 0 0 0 8px rgba(0,0,0,0);} 100%{ box-shadow: 0 0 0 0 rgba(0,0,0,0);} }
.btn-added { animation: pop-in .35s ease; }
.btn-ring { animation: pulse-ring .6s ease; }

/* Floating dot to fly towards target icon */
.fly-dot { position: fixed; width: 12px; height: 12px; border-radius: 9999px; background: #111; pointer-events: none; z-index: 1100; transition: transform .6s cubic-bezier(.22,.61,.36,1); }
.fly-dot.fav { background: #ef4444; }
</style>


<style>
/* --- injected (non-destructive) --- */
.k-icon-wrap{position:relative;display:inline-flex}
.k-badge{position:absolute;top:-6px;right:-6px;min-width:18px;height:18px;padding:0 5px;border-radius:9999px;background:rgba(239,68,68,.15);color:#ef4444;font-size:11px;line-height:18px;text-align:center;font-weight:700;pointer-events:none;display:none}
.fav-indicator-on svg{fill:rgba(239,68,68,.15);stroke:#ef4444}
.k-inlist{font-size:12px;color:#6b7280;margin-left:.5rem}
</style>

</head>

<body>
    <div id="root"></div>
    <script type="text/babel">
        // ICON COMPONENTS (No changes here, they remain the same)
        const HomeIcon = (props) => <svg xmlns="http://www.w3.org/2000/svg" width={props.size} height={props.size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={props.className}><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>;
        const UserIcon = (props) => <svg xmlns="http://www.w3.org/2000/svg" width={props.size} height={props.size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={props.className}><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>;
        const UsersIcon = (props) => <svg xmlns="http://www.w3.org/2000/svg" width={props.size} height={props.size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={props.className}><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>;
        const StoreIcon = (props) => <svg xmlns="http://www.w3.org/2000/svg" width={props.size} height={props.size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={props.className}><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5"/><path d="M2 12l10 5 10-5"/></svg>;
        const HeartIcon = (props) => <svg xmlns="http://www.w3.org/2000/svg" width={props.size} height={props.size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={props.className}><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"/></svg>;
        const FileTextIcon = (props) => <svg xmlns="http://www.w3.org/2000/svg" width={props.size} height={props.size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={props.className}><path d="M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"/><path d="M14 2v4a2 2 0 0 0 2 2h4"/><path d="M10 9H8"/><path d="M16 13H8"/><path d="M16 17H8"/></svg>;
        const SearchIcon = (props) => <svg xmlns="http://www.w3.org/2000/svg" width={props.size} height={props.size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={props.className}><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>;
        const ShoppingBagIcon = (props) => <svg xmlns="http://www.w3.org/2000/svg" width={props.size} height={props.size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={props.className}><path d="M6 2 3 7v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V7l-3-5z"/><path d="M3 7h18"/><path d="M16 8a4 4 0 0 1-8 0"/></svg>;
        const ChevronDownIcon = (props) => <svg xmlns="http://www.w3.org/2000/svg" width={props.size} height={props.size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={props.className}><path d="m6 9 6 6 6-6"/></svg>;
        const ChevronRightIcon = (props) => <svg xmlns="http://www.w3.org/2000/svg" width={props.size} height={props.size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={props.className}><path d="m9 18 6-6-6-6"/></svg>;
        const MenuIcon = (props) => <svg xmlns="http://www.w3.org/2000/svg" width={props.size} height={props.size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={props.className}><line x1="4" y1="12" x2="20" y2="12"></line><line x1="4" y1="6" x2="20" y2="6"></line><line x1="4" y1="18" x2="20" y2="18"></line></svg>;
        const XIcon = (props) => <svg xmlns="http://www.w3.org/2000/svg" width={props.size} height={props.size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={props.className}><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>;
        const TrophyIcon = (props) => <svg xmlns="http://www.w3.org/2000/svg" width={props.size} height={props.size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={props.className}><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"/><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"/><path d="M4 22h16"/><path d="M10 14.66V22h4v-7.34"/><path d="M7 9v1.66a4 4 0 0 0 1.25 2.9A4 4 0 0 0 12 15a4 4 0 0 0 3.75-1.44A4 4 0 0 0 17 10.66V9"/><path d="M12 15V9"/></svg>;
        const HelpCircleIcon = (props) => <svg xmlns="http://www.w3.org/2000/svg" width={props.size} height={props.size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={props.className}><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>;
        const PhoneIcon = (props) => <svg xmlns="http://www.w3.org/2000/svg" width={props.size} height={props.size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={props.className}><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.63A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></svg>;
        const LogOutIcon = (props) => <svg xmlns="http://www.w3.org/2000/svg" width={props.size} height={props.size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={props.className}><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>;
        const MapPinIcon = (props) => <svg xmlns="http://www.w3.org/2000/svg" width={props.size} height={props.size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={props.className}><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></svg>;
        const CreditCardIcon = (props) => <svg xmlns="http://www.w3.org/2000/svg" width={props.size} height={props.size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={props.className}><rect width="20" height="14" x="2" y="5" rx="2"/><line x1="2" x2="22" y1="10" y2="10"/></svg>;
        
        // TRANSLATIONS OBJECT (No changes here, it remains the same)
        const translations = {
            'Türkçe': {
                discover: 'KEŞFET',
                newIn: 'Yeni Gelenler',
                newInDesc: 'Her hafta gelen en yeni parçalarımızı keşfedin.',
                shopNewIn: 'YENİ GELENLERİ KEŞFET',
                decor: 'Dekor',
                lighting: 'Aydınlatma',
                rugs: 'Halılar',
                armchairs: 'Koltuklar',
                tables: 'Masalar',
                storage: 'Depolama',
                allCategories: 'TÜM KATEGORİLER',
                designers: 'TASARIMCILAR',
                seating: 'OTURMA GRUPLARI',
                masters: 'USTALAR',
                shopByRoom: 'ODAYA GÖRE ALIŞVERİŞ',
                ourGalleries: 'GALERİLERİMİZ',
                home: 'Anasayfa',
                collectionHighlight: 'İlham Veren Markalar',
                perfectLiving: 'MÜKEMMEL YAŞAM',
                iconicTables: 'İkonik Masalar',
                collectorPanel: 'Koleksiyoner Paneli',
                atelierPanel: 'Atelier Paneli',
                adminPanel: 'Yönetici Paneli',
                login: 'Giriş Yap',
                logout: 'Çıkış Yap',
                newAddress: 'Yeni Adres',
                contact: 'İletişim',
                faq: 'Sıkça Sorulan Sorular',
                turkce: 'Türkçe',
                english: 'English',
                deutsch: 'Deutsch',
                tagline1: 'Tasarımın yeni adresi.',
                tagline2: 'Yaşam alanlarınıza değer katın. Özenle seçilmiş mobilya, aydınlatma ve dekorasyon ürünleriyle tanışın.',
                exploreLogin: 'Hemen Keşfet / Giriş Yap',
                furniture: 'Mobilya',
                furnitureDesc: 'Evinizin kalbini oluşturan özel tasarım mobilyalar.',
                genelHata: 'Bir hata oluştu. Lütfen tekrar deneyin.',
                lightingDesc: 'Mekanlarınıza ışık ve estetik katan tasarımlar.',
                decorationDesc: 'Detaylarla fark yaratan benzersiz dekoratif objeler.',
                collectorLogin: 'Koleksiyoner Girişi',
                email: 'E-posta',
                password: 'Şifre',
                invalidCredentials: 'Hatalı e-posta veya şifre. Lütfen tekrar deneyin.',
                sampleAccounts: 'Örnek Hesaplar:',
                collector: 'Koleksiyoner',
                atelier: 'Atelier',
                admin: 'Yönetici',
                wantToBeDesigner: 'Tasarımcı Ortağımız olmak ister misiniz?',
                atelierPartnershipApplication: 'Atelier Ortaklık Başvurusu',
                applicationReceived: 'Başvurunuz başarıyla alındı!',
                contactSoon: 'En kısa sürede sizinle iletişime geçeceğiz.',
                backToLogin: 'Giriş Sayfasına Dön',
                atelierName: 'Atelier Adı',
                fullName: 'Ad Soyad',
                confirmPassword: 'Şifre Tekrar',
                portfolioLink: 'Portfolyo Linki (Opsiyonel)',
                passwordsMismatch: 'Şifreler uyuşmuyor. Lütfen kontrol edin.',
                submitApplication: 'Başvuruyu Gönder',
                alreadyHaveAccount: 'Zaten hesabın var mı?',
                overview: 'Genel Bakış',
                productManagement: 'Ürün Yönetimi',
                ordersFinance: 'Siparişler & Finans',
                atelierReview: 'Atelier İncelemesi',
                last30Days: 'Son 30 gün içinde',
                mostPopularProduct: 'En Çok İlgi Çeken Ürün',
                views: 'görüntülenme',
                productViews: 'Ürün Görüntülenme Sayısı',
                totalViews: 'Toplam görüntülenme',
                addToFavoritesRate: 'Favorilere Eklenme Oranı',
                averageRate: 'Ortalama oran',
                addProductManage: 'Ürün Ekle/Yönet',
                addNewProduct: 'Yeni Ürün Ekle',
                productName: 'Ürün Adı',
                productDescription: 'Ürün Açıklaması',
                productStory: 'Ürünün Hikayesi',
                price: 'Fiyat',
                category: 'Kategori',
                materialInfo: 'Materyal Bilgisi',
                dimensionsCm: 'Boyutlar (cm)',
                weightKg: 'Ağırlık (kg)',
                shippingInfo: 'Kargo Bilgileri',
                professionalPhotoGallery: 'Profesyonel Fotoğraf Galerisi',
                uploadPhotos: 'En az 3, en fazla 10 fotoğraf yükleyin.',
                saveProduct: 'Ürünü Kaydet',
                currentProducts: 'Mevcut Ürünler',
                active: 'Aktif',
                passive: 'Pasif',
                orders: 'Siparişler',
                lastOrders: 'Son Siparişler',
                completed: 'Tamamlandı',
                inTransit: 'Kargoda',
                cancelled: 'İptal Edildi',
                financialStatus: 'Finansal Durum',
                withdrawableBalance: 'Çekilebilir Bakiye',
                currentBalance: 'Güncel bakiye',
                totalEarnings: 'Toplam Kazanç',
                allTime: 'Tüm zamanlar',
                withdrawBalance: 'Bakiye Çek',
                myOrders: 'Siparişlerim',
                messageDesigner: 'Tasarımcıya Mesaj Gönder',
                favorites: 'Favorilerim',
                favoriteDesigns: 'Favori Tasarımlar',
                favoriteAteliers: 'Favori Atelierler',
                profileManagement: 'Profil Yönetimi',
                deliveryAddresses: 'Teslimat Adresleri',
                addressTitle: 'Adres Başlığı',
                addressLine1: 'Adres Satırı 1',
                addressLine2: 'Adres Satırı 2 (Opsiyonel)',
                city: 'İl',
                district: 'İlçe',
                zipCode: 'Posta Kodu',
                saveAddress: 'Adresi Kaydet',
                billingInformation: 'Fatura Bilgileri',
                nameSurnameCompanyName: 'Ad Soyad / Firma Adı',
                tcIdTaxNo: 'TC Kimlik No / Vergi No',
                saveBillingInfo: 'Fatura Bilgilerini Kaydet',
                galleryManagerPanel: 'Galeri Yöneticisi Paneli',
                userManager: 'Kullanıcı Yönetimi',
                designerApplications: 'Tasarımcı Başvuruları',
                pending: 'Beklemede',
                approved: 'Onaylandı',
                allUsers: 'Tüm Kullanıcılar',
                view: 'Görüntüle',
                approve: 'Onayla',
                allListedProducts: 'Tüm Listelenen Ürünler',
                featuredProducts: 'Öne Çıkarılan Ürünler',
                manageFeaturedProducts: 'Öne Çıkarılan Ürünleri Yönet',
                financeManagement: 'Finans Yönetimi',
                commissionRates: 'Komisyon Oranları',
                currentCommissionRate: 'Mevcut Komisyon Oranı:',
                setCommissionRate: 'Komisyon Oranını Ayarla',
                designerPayments: 'Tasarımcı Ödemeleri',
                managePayments: 'Ödemeleri Yönet',
                incomeExpenseReports: 'Gelir ve Gider Raporları',
                viewReports: 'Raporları Görüntüle',
                contentManagement: 'İçerik Yönetimi',
                homePageBanners: 'Ana Sayfa Bannerları',
                manageBanners: 'Bannerları Yönet',
                specialCollectionPages: 'Özel Koleksiyon Sayfaları',
                manageCollections: 'Koleksiyonları Yönet',
                blogPosts: 'Blog Yazıları',
                manageBlogPosts: 'Blog Yazılarını Yönet',
                orderId: 'Sipariş ID:',
                product: 'Ürün:',
                date: 'Tarih:',
                categoryManagement: 'Kategori Yönetimi',
                mainCategories: 'Ana Kategoriler',
                subCategories: 'Alt Kategoriler',
                addCategory: 'Kategori Ekle',
                editCategory: 'Kategoriyi Düzenle',
                deleteCategory: 'Kategoriyi Sil',
                categoryName: 'Kategori Adı',
                parentCategory: 'Üst Kategori',
                saveCategory: 'Kategoriyi Kaydet',
                searchProduct: 'Ürün, marka, içerik ara',
                new: 'Yeni',
                woman: 'Kadın',
                man: 'Erkek',
                child: 'Çocuk',
                life: 'Yaşam',
                brands: 'Markalar',
                discount: 'İndirim',
                mag: 'MAG',
                rewards: 'Rewards',
                stores: 'Mağazalar',
                forGood: 'for good',
                edit: 'Düzenle',
                delete: 'Sil',
                sales: 'satış',
                unitsSold: 'adet satış',
                platformWide: 'Platform genelinde',
                artPiece: 'Sanat Eseri',
                lastViewedProduct: 'Son Görüntülenen Ürün',
                today: 'Bugün',
                modernScandinavianDesigns: 'Modern İskandinav Tasarımları',
                naturalWoodCollection: 'Doğal Ahşap Koleksiyonu',
                shopBy: 'SHOP BY',
                décor: 'DÉCOR',
                gifts: 'GIFTS',
                services: 'SERVICES',
                appointmentBooking: 'RANDEVU AL',
                tradeProgram: 'TİCARİ PROGRAM',
                internationalDeliveries: 'ULUSLARARASI TESLİMAT',
                paymentMethods: 'ÖDEME YÖNTEMLERİ',
                returnsPolicy: 'İADE POLİTİKASI',
                followUs: 'BİZİ TAKİP EDİN',
                pinterest: 'PINTEREST',
                instagram: 'INSTAGRAM',
                linkedin: 'LINKEDIN',
                youtube: 'YOUTUBE',
                about: 'HAKKINDA',
                aboutUs: 'HAKKIMIZDA',
                theTeam: 'EKİP',
                ourValues: 'DEĞERLERİMİZ',
                catalogs: 'KATALOGLAR',
                bCorp: 'B CORP',
                inspirations: 'İLHAM KAYNAKLARI',
                press: 'BASIN',
                podcast: 'PODCAST',
                howTo: 'NASIL YAPILIR',
                careers: 'KARİYER',
                legalNotice: 'YASAL UYARI',
                privacyPolicy: 'GİZLİLİK POLİTİKASI',
                subscribeToNewsletter: 'Bültenimize Abone Olun',
                subscribe: 'ABONE OL',
                proudToBeBCorp: 'Sertifikalı B Corporation™ olmaktan gurur duyuyoruz',
                bCorpDescription: 'Bu şirket, en yüksek doğrulanmış sosyal ve çevresel performans, şeffaflık ve hesap verebilirlik standartlarını karşılamaktadır.',
                allRightsReserved: 'Tüm hakları saklıdır.',
                editorSelection: "Editör'ün ",
                summer: 'Yaz',
                selection: ' Seçkisi',
                laclaud: 'Laclaud',
                inspiringBrands: 'İlham Veren Markalar',
                dekoriGroup: 'Dekori Grup',
                summerSale: "Yaz İndirimi! %50'ye Varan İndirimler",
                newArrivals: "Yeni Gelenler Stokta!",
                raysDiscount: "RAYS Tüm Ürünlerde %30'a Varan İndirim",
                discoverThisWeeksHighlights: "Bu Haftanın Öne Çıkanlarını Keşfet!",
                freeShipping: "Ücretsiz Kargoyu Kaçırmayın!",
                joinNow: 'ŞİMDİ KATIL',
                worldwideDeliveries: 'Dünya Çapında Teslimat',
                worldwideDeliveriesDesc: 'Tüm gönderilerimiz sigortalıdır ve uzman taşıyıcılar tarafından işlenir',
                securePayment: 'Güvenli Ödeme',
                securePaymentDesc: 'Kredi kartı, PayPal veya banka havalesi ile tam güvenlik ve gizlilik içinde ödeme yapabilirsiniz',
                teamOfSpecialistAdvisers: 'Uzman Danışman Ekibi',
                teamOfSpecialistAdvisersDesc: 'Tasarım uzmanlarımızdan oluşan ekibimiz yardım etmek için burada ve tüm sorularınızı ve kişiselleştirilmiş taleplerinizi yanıtlayacaktır',
                certificateOfAuthenticity: 'Orijinallik Sertifikası',
                certificateOfAuthenticityDesc: 'Her parça orijinaldir ve sertifikalıdır',
                curatedSelections: 'Küratörlü Seçkiler',
                curatedSelectionsDesc: 'Her ürün, yalnızca estetik değil bir fikir taşıdığı için seçilir. Kadraj’da sadece görünür değil, anlamlı olan tasarımlar yer alır.',
                directArtistSupport: 'Sanatçıya Doğrudan Destek',
                directArtistSupportDesc: 'Satın aldığınız her parça, üreticisinin emeğine doğrudan katkı sağlar. Komisyon sistemimiz adil, şeffaf ve sanatçı dostudur.',
                securePaymentProcess: 'Ödeme, teslimat ve iade süreçlerinde yüksek standartları benimsiyoruz.',
                expertAdviserTeam: 'Uzman Danışman Ekibi',
                expertAdviserTeamDesc: 'Tasarım uzmanlarımız tüm sorularınızı ve kişisel taleplerinizi yanıtlamak için burada.',
                homeBar: "Anasayfa",
                favoritesBar: "Favoriler",
                sepetimBar: "Sepetim",
                hesabimBar: "Hesabım",
                Menu: "Menü",
                elbiseler: 'Elbiseler',
                abiyeler: 'Abiyeler',
                deriKoleksiyonu: 'Deri Koleksiyonu',
                kabanlar: 'Kabanlar',
                sweatshirt: 'Sweatshirt',
                takimlar: 'Takımlar',
                outlet: 'Outlet',
                kadrajSociety: 'Kadraj Society',
                hakkimizda: 'Hakkımızda',
                sss: 'S.S.S',
                iletisim: 'İletişim',
                noAccount: "Hesabınız yok mu?",
                signUp: "Kayıt Olun",
                userRegistration: "Kullanıcı Kaydı",
                createAccount: "Hesap Oluştur",
                registrationSuccess: "Kaydınız başarıyla tamamlandı!",
                canNowLogin: "Şimdi giriş yapabilirsiniz.",
            },
            'English': {
                discover: 'DISCOVER',
                newIn: 'NEW IN',
                newInDesc: 'Discover our latest pieces, arriving every week.',
                shopNewIn: 'SHOP NEW IN',
                decor: 'Décor',
                lighting: 'Lighting',
                rugs: 'Rugs',
                armchairs: 'Armchairs',
                tables: 'Tables',
                storage: 'Storage',
                allCategories: 'ALL CATEGORIES',
                designers: 'DESIGNERS',
                seating: 'SEATING',
                masters: 'MASTERS',
                shopByRoom: 'SHOP BY ROOM',
                ourGalleries: 'OUR GALLERIES',
                home: 'Homepage',
                collectorPanel: 'Collector Panel',
                atelierPanel: 'Atelier Panel',
                adminPanel: 'Admin Panel',
                login: 'Login',
                logout: 'Logout',
                newAddress: 'New Address',
                contact: 'Contact',
                faq: 'Frequently Asked Questions',
                turkce: 'Türkçe',
                english: 'English',
                deutsch: 'Deutsch',
                tagline1: 'The new address of design.',
                tagline2: 'Add value to your living spaces. Discover carefully selected furniture, lighting and home decor products.',
                exploreLogin: 'Explore Now / Login',
                furniture: 'Furniture',
                decoration: 'Decoration',
                furnitureDesc: 'Special design furniture that forms the heart of your home.',
                genelHata: 'An error occurred. Please try again.',
                lightingDesc: 'Designs that add light and aesthetics to your spaces.',
                decorationDesc: 'Unique decorative objects that make a difference with details.',
                collectorLogin: 'Collector Login',
                email: 'Email',
                password: 'Password',
                invalidCredentials: 'Invalid email or password. Please try again.',
                sampleAccounts: 'Sample Accounts:',
                collector: 'Collector',
                atelier: 'Atelier',
                admin: 'Admin',
                wantToBeDesigner: 'Want to be a Designer Partner?',
                atelierPartnershipApplication: 'Atelier Partnership Application',
                applicationReceived: 'Your application has been successfully received!',
                contactSoon: 'We will contact you as soon as possible.',
                backToLogin: 'Back to Login Page',
                atelierName: 'Atelier Name',
                fullName: 'Full Name',
                confirmPassword: 'Confirm Password',
                portfolioLink: 'Portfolio Link (Optional)',
                shortDescription: 'Short Description (Optional)',
                passwordsMismatch: 'Passwords do not match. Please check.',
                submitApplication: 'Submit Application',
                alreadyHaveAccount: 'Already have an account?',
                overview: 'Overview',
                productManagement: 'Product Management',
                ordersFinance: 'Orders & Finance',
                atelierReview: 'Atelier Review',
                last30Days: 'Last 30 days',
                mostPopularProduct: 'Most Popular Product',
                views: 'views',
                productViews: 'Product View Count',
                totalViews: 'Total views',
                addToFavoritesRate: 'Add to Favorites Rate',
                averageRate: 'Average rate',
                addProductManage: 'Add/Manage Product',
                addNewProduct: 'Add New Product',
                productName: 'Product Name',
                productDescription: 'Product Description',
                productStory: 'Product Story',
                price: 'Price',
                category: 'Category',
                materialInfo: 'Material Information',
                dimensionsCm: 'Dimensions (cm)',
                weightKg: 'Weight (kg)',
                shippingInfo: 'Shipping Information',
                professionalPhotoGallery: 'Professional Photo Gallery',
                uploadPhotos: 'Upload at least 3, maximum 10 photos.',
                saveProduct: 'Save Product',
                currentProducts: 'Current Products',
                active: 'Active',
                passive: 'Passive',
                orders: 'Orders',
                lastOrders: 'Last Orders',
                completed: 'Completed',
                inTransit: 'In Transit',
                cancelled: 'Cancelled',
                financialStatus: 'Financial Status',
                withdrawableBalance: 'Withdrawable Balance',
                currentBalance: 'Current balance',
                totalEarnings: 'Total Earnings',
                allTime: 'All time',
                withdrawBalance: 'Withdraw Balance',
                myOrders: 'My Orders',
                messageDesigner: 'Message Designer',
                favorites: 'Favorites',
                favoriteDesigns: 'Favorite Designs',
                favoriteAteliers: 'Favorite Ateliers',
                profileManagement: 'Profile Management',
                deliveryAddresses: 'Delivery Addresses',
                addressTitle: 'Address Title',
                addressLine1: 'Address Line 1',
                addressLine2: 'Address Line 2 (Optional)',
                city: 'City',
                district: 'District',
                zipCode: 'Zip Code',
                saveAddress: 'Save Address',
                billingInformation: 'Billing Information',
                nameSurnameCompanyName: 'Name Surname / Company Name',
                tcIdTaxNo: 'TR ID No / Tax No',
                saveBillingInfo: 'Save Billing Information',
                galleryManagerPanel: 'Gallery Manager Panel',
                userManager: 'User Management',
                designerApplications: 'Designer Applications',
                pending: 'Pending',
                approved: 'Approve',
                allUsers: 'All Users',
                view: 'View',
                approve: 'Approve',
                allListedProducts: 'All Listed Products',
                featuredProducts: 'Manage Featured Products',
                financeManagement: 'Finance Management',
                commissionRates: 'Commission Rates',
                currentCommissionRate: 'Current Commission Rate:',
                setCommissionRate: 'Set Commission Rate',
                designerPayments: 'Designer Payments',
                managePayments: 'Manage Payments',
                incomeExpenseReports: 'Income and Expense Reports',
                viewReports: 'View Reports',
                contentManagement: 'Content Management',
                homePageBanners: 'Home Page Banners',
                manageBanners: 'Manage Banners',
                specialCollectionPages: 'Special Collection Pages',
                manageCollections: 'Manage Collections',
                blogPosts: 'Blog Posts',
                manageBlogPosts: 'Manage Blog Posts',
                orderId: 'Order ID:',
                product: 'Product:',
                date: 'Date:',
                categoryManagement: 'Category Management',
                mainCategories: 'Main Categories',
                subCategories: 'Sub Categories',
                addCategory: 'Add Category',
                editCategory: 'Edit Category',
                deleteCategory: 'Delete Category',
                categoryName: 'Category Name',
                parentCategory: 'Parent Category',
                saveCategory: 'Save Category',
                searchProduct: 'Search product, brand, content',
                new: 'New',
                woman: 'Woman',
                man: 'Man',
                child: 'Child',
                life: 'Life',
                brands: 'Brands',
                discount: 'Discount',
                mag: 'MAG',
                rewards: 'Rewards',
                stores: 'Stores',
                forGood: 'for good',
                edit: 'Edit',
                delete: 'Delete',
                sales: 'sales',
                unitsSold: 'units sold',
                platformWide: 'Platform wide',
                artPiece: 'Art Piece',
                lastViewedProduct: 'Last Viewed Product',
                today: 'Today',
                modernScandinavianDesigns: 'Modern Scandinavian Designs',
                naturalWoodCollection: 'Natural Wood Collection',
                shopBy: 'SHOP BY',
                décor: 'DÉCOR',
                gifts: 'GIFTS',
                services: 'SERVICES',
                appointmentBooking: 'APPOINTMENT BOOKING',
                tradeProgram: 'TRADE PROGRAM',
                internationalDeliveries: 'INTERNATIONAL DELIVERIES',
                paymentMethods: 'PAYMENT METHODS',
                returnsPolicy: 'RETURNS POLICY',
                followUs: 'FOLLOW US',
                pinterest: 'PINTEREST',
                instagram: 'INSTAGRAM',
                linkedin: 'LINKEDIN',
                youtube: 'YOUTUBE',
                about: 'ABOUT',
                aboutUs: 'ABOUT US',
                theTeam: 'THE TEAM',
                ourValues: 'OUR VALUES',
                catalogs: 'CATALOGS',
                bCorp: 'B CORP',
                inspirations: 'INSPIRATIONS',
                press: 'PRESS',
                podcast: 'PODCAST',
                howTo: 'HOW-TO',
                careers: 'CAREERS',
                legalNotice: 'LEGAL NOTICE',
                privacyPolicy: 'PRIVACY POLICY',
                subscribeToNewsletter: 'Subscribe to our Newsletter',
                subscribe: 'SUBSCRIBE',
                proudToBeBCorp: 'Proud to be Certified B Corporation™',
                bCorpDescription: 'This company meets the highest verified standards of social and environmental performance, transparency, and accountability.',
                allRightsReserved: 'All rights reserved.',
                editorSelection: 'Editor\'s ',
                summer: 'Summer',
                selection: ' Selection',
                laclaud: 'Laclaud',
                inspiringBrands: 'Inspiring Brands',
                dekoriGroup: 'Dekori Group',
                perfectLiving: 'PERFECT LIVING',
                iconicTables: 'Iconic Tables',
                summerSale: "Summer Sale! Up to 50% Off",
                newArrivals: "New Arrivals in Stock!",
                raysDiscount: "RAYS Up to 30% Off All Products",
                discoverThisWeeksHighlights: "Discover This Week's Highlights!",
                freeShipping: "Don't Miss Free Shipping!",
                joinNow: 'JOIN NOW',
                worldwideDeliveries: 'Worldwide Deliveries',
                worldwideDeliveriesDesc: 'All our shipments are insured and processed by specialized carriers',
                securePayment: 'Secure Payment',
                securePaymentDesc: 'You can pay by credit card, PayPal or bank transfer in complete security and privacy',
                teamOfSpecialistAdvisers: 'Team of Specialist Advisers',
                teamOfSpecialistAdvisersDesc: 'Our team of design specialists are here to help and will answer all your questions and personalized requests',
                certificateOfAuthenticity: 'Certificate Of Authenticity',
                certificateOfAuthenticityDesc: 'Each piece is authentic and certified',
                curatedSelections: 'Curated Selections',
                curatedSelectionsDesc: 'Each product is selected not only for its aesthetics but for the idea it carries. At Kadraj, you will find designs that are not just visible but meaningful.',
                directArtistSupport: 'Direct Artist Support',
                directArtistSupportDesc: 'Every piece you purchase directly contributes to the creator\'s livelihood. Our commission system is fair, transparent, and artist-friendly.',
                securePaymentProcess: 'We uphold high standards in payment, delivery, and return processes. All your purchases are insured, protected, and trackable.',
                expertAdviserTeam: 'Expert Adviser Team',
                expertAdviserTeamDesc: 'Our design specialists are here to answer all your questions and personal requests.',
                homeBar: "Home",
                favoritesBar: "Favorites",
                sepetimBar: "My Cart",
                hesabimBar: "My Account",
                Menu: 'Menu',
                elbiseler: 'Dresses',
                abiyeler: 'Evening Gowns',
                deriKoleksiyonu: 'Leather Collection',
                kabanlar: 'Coats',
                sweatshirt: 'Sweatshirt',
                takimlar: 'Suits',
                outlet: 'Outlet',
                kadrajSociety: 'Kadraj Society',
                hakkimizda: 'About Us',
                sss: 'FAQ',
                iletisim: 'Contact',
                noAccount: "Don't have an account?",
                signUp: "Sign Up",
                userRegistration: "User Registration",
                createAccount: "Create Account",
                registrationSuccess: "Your registration is complete!",
                canNowLogin: "You can now log in.",
            },
            'Deutsch': {
                discover: 'ENTDECKEN',
                newIn: 'NEUHEITEN',
                newInDesc: 'Entdecken Sie unsere neuesten Stücke, die jede Woche eintreffen.',
                shopNewIn: 'NEUHEITEN KAUFEN',
                decor: 'Dekor',
                lighting: 'Beleuchtung',
                rugs: 'Teppiche',
                armchairs: 'Sessel',
                tables: 'Tische',
                storage: 'Lagerung',
                allCategories: 'ALLE KATEGORIEN',
                designers: 'DESIGNER',
                seating: 'SITZMÖBEL',
                masters: 'MEISTER',
                shopByRoom: 'SHOP NACH ZIMMER',
                ourGalleries: 'UNSERE GALERIEN',
                home: 'Startseite',
                collectorPanel: 'Sammler-Panel',
                atelierPanel: 'Atelier-Panel',
                adminPanel: 'Admin-Panel',
                login: 'Anmelden',
                logout: 'Abmelden',
                newAddress: 'Neue Adresse',
                contact: 'Kontakt',
                faq: 'Häufig gestellte Fragen',
                turkce: 'Türkçe',
                english: 'English',
                deutsch: 'Deutsch',
                tagline1: 'Die neue Adresse des Designs.',
                tagline2: 'Verleihen Sie Ihren Wohnräumen Wert. Entdecken Sie sorgfältig ausgewählte Möbel, Beleuchtung und Heimdekorationsprodukte.',
                exploreLogin: 'Jetzt entdecken / Anmelden',
                furniture: 'Möbel',
                decoration: 'Dekoration',
                furnitureDesc: 'Spezielle Designermöbel, die das Herzstück Ihres Zuhauses bilden.',
                genelHata: 'Ein Fehler ist aufgetreten. Bitte versuchen Sie es erneut.',
                lightingDesc: 'Designs, die Ihren Räumen Licht und Ästhetik verleihen.',
                decorationDesc: 'Einzigartige Dekorationsgegenstände, die mit Details den Unterschied machen.',
                collectorLogin: 'Sammler-Login',
                email: 'E-Mail',
                password: 'Passwort',
                invalidCredentials: 'Ungültige E-Mail oder Passwort. Bitte versuchen Sie es erneut.',
                sampleAccounts: 'Beispielkonten:',
                collector: 'Sammler',
                atelier: 'Atelier',
                admin: 'Admin',
                wantToBeDesigner: 'Möchten Sie Designpartner werden?',
                atelierPartnerschaftsantrag: 'Atelier-Partnerschaftsantrag',
                applicationReceived: 'Ihr Antrag wurde erfolgreich empfangen!',
                contactSoon: 'Wir werden uns so schnell wie möglich mit Ihnen in Verbindung setzen.',
                backToLogin: 'Zur Anmeldeseite zurückkehren',
                atelierName: 'Atelier-Name',
                fullName: 'Vollständiger Name',
                confirmPassword: 'Passwort bestätigen',
                portfolioLink: 'Portfolio-Link (Optional)',
                shortDescription: 'Kurze Beschreibung (Optional)',
                passwordsMismatch: 'Passwörter stimmen nicht überein. Bitte überprüfen Sie.',
                submitApplication: 'Antrag absenden',
                alreadyHaveAccount: 'Haben Sie bereits ein Konto?',
                overview: 'Übersicht',
                productManagement: 'Produktverwaltung',
                ordersFinance: 'Bestellungen & Finanzen',
                atelierReview: 'Atelier-Bewertung',
                last30Days: 'Letzte 30 Tage',
                mostPopularProduct: 'Beliebtestes Produkt',
                views: 'Ansichten',
                productViews: 'Produktansichtszahl',
                totalViews: 'Gesamtansichten',
                addToFavoritesRate: 'Zu Favoriten hinzufügen Rate',
                averageRate: 'Durchschnittliche Rate',
                addProductManage: 'Produkt hinzufügen/verwalten',
                addNewProduct: 'Neues Produkt hinzufügen',
                productName: 'Produktname',
                productDescription: 'Produktbeschreibung',
                productStory: 'Produktgeschichte',
                price: 'Preis',
                category: 'Kategorie',
                materialInfo: 'Materialinformationen',
                dimensionsCm: 'Abmessungen (cm)',
                weightKg: 'Gewicht (kg)',
                shippingInfo: 'Versandinformationen',
                professionalPhotoGallery: 'Professionelle Fotogalerie',
                uploadPhotos: 'Laden Sie mindestens 3, maximal 10 Fotos hoch.',
                saveProduct: 'Produkt speichern',
                currentProducts: 'Aktuelle Produkte',
                active: 'Aktiv',
                passive: 'Pasiv',
                orders: 'Bestellungen',
                lastOrders: 'Letzte Bestellungen',
                completed: 'Abgeschlossen',
                inTransit: 'Unterwegs',
                cancelled: 'Storniert',
                financialStatus: 'Finanzstatus',
                withdrawableBalance: 'Auszahlbarer Saldo',
                currentBalance: 'Aktueller Saldo',
                totalEarnings: 'Gesamteinnahmen',
                allTime: 'Gesamtzeit',
                withdrawBalance: 'Saldo abheben',
                myOrders: 'Meine Bestellungen',
                messageDesigner: 'Designer benachrichtigen',
                favorites: 'Favoriten',
                favoriteDesigns: 'Lieblingsdesigns',
                favoriteAteliers: 'Lieblingsateliers',
                profileManagement: 'Profilverwaltung',
                deliveryAddresses: 'Lieferadressen',
                addressTitle: 'Adressbezeichnung',
                addressLine1: 'Adresszeile 1',
                addressLine2: 'Adresszeile 2 (Optional)',
                city: 'Stadt',
                district: 'Bezirk',
                zipCode: 'Postleitzahl',
                saveAddress: 'Adresse speichern',
                billingInformation: 'Rechnungsinformationen',
                nameSurnameCompanyName: 'Name Nachname / Firmenname',
                tcIdTaxNo: 'TR ID-Nr. / Steuernummer',
                saveBillingInfo: 'Rechnungsinformationen speichern',
                galleryManagerPanel: 'Galerie-Manager-Panel',
                userManager: 'Benutzerverwaltung',
                designerApplications: 'Designer-Anträge',
                pending: 'Ausstehend',
                approved: 'Genehmigt',
                allUsers: 'Alle Benutzer',
                view: 'Anzeigen',
                approve: 'Genehmigen',
                allListedProducts: 'Alle gelisteten Produkte',
                featuredProducts: 'Ausgewählte Produkte',
                manageFeaturedProducts: 'Ausgewählte Produkte verwalten',
                financeManagement: 'Finanzverwaltung',
                commissionRates: 'Provisionssätze',
                currentCommissionRate: 'Aktueller Provisionssatz:',
                setCommissionRate: 'Provisionssatz festlegen',
                designerPayments: 'Designer-Zahlungen',
                managePayments: 'Zahlungen verwalten',
                incomeExpenseReports: 'Einnahmen- und Ausgabenberichte',
                viewReports: 'Berichte anzeigen',
                contentManagement: 'Inhaltsverwaltung',
                homePageBanners: 'Startseiten-Banner',
                manageBanners: 'Banner verwalten',
                specialCollectionPages: 'Spezielle Kollektionsseiten',
                manageCollections: 'Kollektionen verwalten',
                blogPosts: 'Blogbeiträge',
                manageBlogPosts: 'Blogbeiträge verwalten',
                orderId: 'Bestell-ID:',
                product: 'Produkt:',
                date: 'Datum:',
                categoryManagement: 'Kategorienverwaltung',
                mainCategories: 'Hauptkategorien',
                subCategories: 'Unterkategorien',
                addCategory: 'Kategorie hinzufügen',
                editCategory: 'Kategorie bearbeiten',
                deleteCategory: 'Kategorie löschen',
                categoryName: 'Kategoriename',
                parentCategory: 'Übergeordnete Kategorie',
                saveCategory: 'Kategorie speichern',
                searchProduct: 'Produkt, Marke, Inhalt suchen',
                new: 'Neu',
                woman: 'Frau',
                man: 'Mann',
                child: 'Kind',
                life: 'Leben',
                brands: 'Marken',
                discount: 'Rabatt',
                mag: 'MAG',
                rewards: 'Rewards',
                stores: 'Geschäfte',
                forGood: 'for good',
                edit: 'Bearbeiten',
                delete: 'Löschen',
                sales: 'Verkäufe',
                unitsSold: 'verkaufte Einheiten',
                platformWide: 'Plattformweit',
                artPiece: 'Kunstwerk',
                lastViewedProduct: 'Zuletzt angesehenes Produkt',
                today: 'Heute',
                modernScandinavianDesigns: 'Moderne skandinavische Designs',
                naturalWoodCollection: 'Naturholz-Kollektion',
                shopBy: 'KAUFEN NACH',
                décor: 'DEKOR',
                gifts: 'GESCHENKE',
                services: 'DIENSTLEISTUNGEN',
                appointmentBooking: 'TERMINBUCHUNG',
                tradeProgram: 'HANDELSPROGRAMM',
                internationalDeliveries: 'INTERNATIONALE LIEFERUNGEN',
                paymentMethods: 'ZAHLUNGSMETHODEN',
                returnsPolicy: 'RÜCKGABERECHT',
                followUs: 'FOLGEN SIE UNS',
                pinterest: 'PINTEREST',
                instagram: 'INSTAGRAM',
                linkedin: 'LINKEDIN',
                youtube: 'YOUTUBE',
                about: 'ÜBER UNS',
                aboutUs: 'ÜBER UNS',
                theTeam: 'DAS TEAM',
                ourValues: 'UNSERE WERTE',
                catalogs: 'KATALOGE',
                bCorp: 'B CORP',
                inspirations: 'INSPIRATIONEN',
                press: 'PRESSE',
                podcast: 'PODCAST',
                howTo: 'ANLEITUNGEN',
                careers: 'KARRIERE',
                legalNotice: 'IMPRESSUM',
                privacyPolicy: 'DATENSCHUTZRICHTLINIE',
                subscribeToNewsletter: 'Abonnieren Sie unseren Newsletter',
                subscribe: 'ABONNIEREN',
                proudToBeBCorp: 'Stolz darauf, Certified B Corporation™ zu sein',
                bCorpDescription: 'Dieses Unternehmen erfüllt die höchsten geprüften Standards für soziale und ökologische Leistung, Transparenz und Rechenschaftspflicht.',
                allRightsReserved: 'Alle Rechte vorbehalten.',
                editorSelection: 'Auswahl des Herausgebers ',
                summer: 'Sommer',
                selection: '',
                laclaud: 'Laclaud',
                inspiringBrands: 'Inspirierende Marken',
                dekoriGroup: 'Dekori-Gruppe',
                perfectLiving: 'PERFEKTES WOHNEN',
                iconicTables: 'Ikonische Tische',
                summerSale: "Sommer-Sale! Bis zu 50% Rabatt",
                newArrivals: "Neuheiten auf Lager!",
                raysDiscount: "RAYS Bis zu 30% Rabatt auf alle Produkte",
                discoverThisWeeksHighlights: "Entdecken Sie die Highlights dieser Woche!",
                freeShipping: "Verpassen Sie nicht den kostenlosen Versand!",
                joinNow: 'JETZT BEITRETEN',
                worldwideDeliveries: 'Weltweite Lieferungen',
                worldwideDeliveriesDesc: 'Alle unsere Sendungen sind versichert und werden von spezialisierten Spediteuren bearbeitet',
                securePayment: 'Sichere Bezahlung',
                securePaymentDesc: 'Sie können mit Kreditkarte, PayPal oder Banküberweisung in vollständiger Sicherheit und Privatsphäre bezahlen',
                teamOfSpecialistAdvisers: 'Team von Fachberatern',
                teamOfSpecialistAdvisersDesc: 'Unsere Designexperten helfen Ihnen gerne weiter und beantworten alle Ihre Fragen und individuellen Wünsche',
                certificateOfAuthenticity: 'Echtheitszertifikat',
                certificateOfAuthenticityDesc: 'Jedes Stück ist authentisch und zertifiziert',
                curatedSelections: 'Kuratierte Auswahl',
                curatedSelectionsDesc: 'Jedes Produkt wird nicht nur wegen seiner Ästhetik, sondern auch wegen der Idee, die es trägt, ausgewählt. Bei Kadraj finden Sie Designs, die nicht nur sichtbar, sondern auch bedeutungsvoll sind.',
                directArtistSupport: 'Direkte Künstlerunterstützung',
                directArtistSupportDesc: 'Jeder Kauf, den Sie tätigen, trägt direkt zur Arbeit des Herstellers bei. Unser Provisionssystem ist fair, transparent und künstlerfreundlich.',
                securePaymentProcess: 'Wir setzen hohe Standards bei Zahlungs-, Liefer- und Rückgabeprozessen.',
                expertAdviserTeam: 'Expertenteam für Beratung',
                expertAdviserTeamDesc: 'Unser Team von Designspezialisten steht Ihnen zur Verfügung, um alle Ihre Fragen und persönlichen Anfragen zu beantworten.',
                homeBar: "Startseite",
                favoritesBar: "Favoriten",
                sepetimBar: "Warenkorb",
                hesabimBar: "Mein Konto",
                Menu: 'Menü',
                elbiseler: 'Kleider',
                abiyeler: 'Abendkleider',
                deriKoleksiyonu: 'Lederkollektion',
                kabanlar: 'Mäntel',
                sweatshirt: 'Sweatshirt',
                takimlar: 'Anzüge',
                outlet: 'Outlet',
                kadrajSociety: 'Kadraj Society',
                hakkimizda: 'Über uns',
                sss: 'FAQ',
                iletisim: 'Kontakt',
                noAccount: "Kein Konto?",
                signUp: "Registrieren",
                userRegistration: "Benutzerregistrierung",
                createAccount: "Konto erstellen",
                registrationSuccess: "Ihre Registrierung ist abgeschlossen!",
                canNowLogin: "Sie können sich jetzt anmelden.",
            },
        };

        // Helper components
        const Input = ({ label, type = 'text', placeholder, value, onChange, disabled = false }) => (
            <div>
                <label className="block text-sm font-medium text-gray-700 mb-2">{label}</label>
                <input
                    type={type}
                    placeholder={placeholder}
                    value={value}
                    onChange={onChange}
                    disabled={disabled}
                    className="w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-gray-300 focus:border-gray-300 transition duration-200 ease-in-out disabled:bg-gray-100"
                    required
                />
            </div>
        );
        const TextArea = ({ label, placeholder, value, onChange }) => (
            <div>
                <label className="block text-sm font-medium text-gray-700 mb-2">{label}</label>
                <textarea
                    placeholder={placeholder}
                    value={value}
                    onChange={onChange}
                    className="w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-gray-300 focus:border-gray-300 transition duration-200 ease-in-out h-32"
                ></textarea>
            </div>
        );
        
        // Layout components (Navbar, Footer, etc.)
        const Navbar = ({ t, setCurrentPath, handleUserIconClick, isSearchOpen, setIsSearchOpen, language, setLanguage, currency, setCurrency, setIsMobileMenuOpen }) => {
            
            const [menuItems, setMenuItems] = React.useState([]);
            const [loading, setLoading] = React.useState(true);
        
            React.useEffect(() => {
                const fetchMenuItems = async () => {
                    try {
                        const headerRef = window.doc(window.firebaseFirestore, 'siteConfiguration', 'header');
                        const docSnap = await window.getDoc(headerRef);
                        if (docSnap.exists()) {
                            const sortedItems = docSnap.data().menuItems.sort((a, b) => a.order - b.order);
                            setMenuItems(sortedItems);
                        } else {
                            console.log("Header konfigürasyonu bulunamadı!");
                        }
                    } catch (error) {
                        console.error("Header verisi çekilirken hata:", error);
                    } finally {
                        setLoading(false);
                    }
                };
            
                fetchMenuItems();
            }, []);
        
            return (
                <div className="bg-white">
                    <nav className="border-b border-gray-200">
                        <div className="container mx-auto px-6 md:px-10 flex items-center justify-between py-4">
                            <div className="flex items-center space-x-4">
                                <button className="md:hidden text-gray-700" onClick={() => setIsMobileMenuOpen(true)}>
                                    <MenuIcon size={24} />
                                </button>
                                <div className="hidden md:flex items-center space-x-4">
                                    <div className="relative">
                                        <select
                                            className="appearance-none bg-transparent border-none text-gray-700 cursor-pointer pr-5 font-medium focus:outline-none text-sm"
                                            value={language}
                                            onChange={(e) => setLanguage(e.target.value)}
                                        >
                                            <option value="Türkçe">TR</option>
                                            <option value="English">EN</option>
                                            <option value="Deutsch">DE</option>
                                        </select>
                                        <div className="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700">
                                            <ChevronDownIcon size={16} />
                                        </div>
                                    </div>
                                    <div className="relative">
                                        <select
                                            className="appearance-none bg-transparent border-none text-gray-700 cursor-pointer pr-5 font-medium focus:outline-none text-sm"
                                            value={currency}
                                            onChange={(e) => setCurrency(e.target.value)}
                                        >
                                            <option value="TRY">₺ TRY</option>
                                            <option value="USD">$ USD</option>
                                            <option value="EUR">€ EUR</option>
                                            <option value="GBP">£ GBP</option>
                                        </select>
                                        <div className="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700">
                                            <ChevronDownIcon size={16} />
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div className="flex-grow flex justify-center">
                                <span className="text-xl md:text-3xl font-light tracking-widest uppercase cursor-pointer text-center md:text-left" onClick={() => setCurrentPath('/')}>
                                    KADRAJ L'ATELIER
                                </span>
                            </div>
                            <div className="flex items-center space-x-4 md:space-x-6">
                                <button onClick={() => setIsSearchOpen(!isSearchOpen)} className="text-gray-700 hover:text-gray-300 transition duration-300"><SearchIcon size={24} /></button>
                                <button onClick={handleUserIconClick} className="text-gray-700 hover:text-gray-300 transition duration-300 hidden md:block"><UserIcon size={24} /></button>
                                <button data-open-favorites="true" className="text-gray-700 hover:text-gray-300 transition duration-300 hidden md:block" aria-label="Favoriler" title="Favoriler"><HeartIcon size={24} /></button>
                                <button data-open-cart="true" className="text-gray-700 hover:text-gray-300 transition duration-300 hidden md:block" aria-label="Sepet" title="Sepet"><ShoppingBagIcon size={24} /></button>
                            </div>
                        </div>
                    </nav>
                    <CategoriesMobile t={t} menuItems={menuItems} loading={loading} />
                    <nav className="hidden md:block py-2">
                        <ul className="flex justify-center space-x-8 text-gray-700 text-sm">
                            {loading ? (
                                <li>Yükleniyor...</li>
                            ) : (
                                menuItems.map((item, index) => (
                                    <li key={index}>
                                        <a href={item.url} className="font-normal hover:text-gray-900 transition duration-300 text-[13px]">
                                            {item.title}
                                        </a>
                                    </li>
                                ))
                            )}
                            <li><a href="#" className="font-bold text-[#590219] hover:text-gray-900 transition duration-300 text-[13px]">{t('kadrajSociety')}</a></li>
                        </ul>
                    </nav>
                </div>
            );
        };
        const MobileMenu = ({ t, setCurrentPath, setIsMobileMenuOpen, language, setLanguage, currency, setCurrency }) => {
            const [isLangOpen, setIsLangOpen] = React.useState(false);
            const [isCurrencyOpen, setIsCurrencyOpen] = React.useState(false);
            const menuItems = [
                { key: 'elbiseler', path: '#' }, { key: 'abiyeler', path: '#' },
                { key: 'deriKoleksiyonu', path: '#' }, { key: 'kabanlar', path: '#' },
                { key: 'sweatshirt', path: '#' }, { key: 'takimlar', path: '#' },
                { key: 'outlet', path: '#' }
            ];
            const utilityLinks = [
                { key: 'home', icon: HomeIcon, path: '/' }, { key: 'hakkimizda', icon: TrophyIcon, path: '#' },
                { key: 'sss', icon: HelpCircleIcon, path: '#' }, { key: 'kadrajSociety', icon: UsersIcon, path: '#' },
                { key: 'iletisim', icon: PhoneIcon, path: '#' },
            ];
            const handleNavigation = (path) => {
                setCurrentPath(path);
                setIsMobileMenuOpen(false);
            };
            const handleLangChange = (lang) => {
                setLanguage(lang);
                setIsLangOpen(false);
            };
            const handleCurrencyChange = (curr) => {
                setCurrency(curr);
                setIsCurrencyOpen(false);
            };
            return (
                <div className="fixed inset-0 bg-white z-50 p-4 flex flex-col animate-fade-in-down h-screen">
                    <div className="flex justify-between items-center pb-3 border-b">
                        <span className="font-light tracking-widest uppercase text-lg cursor-pointer" onClick={() => handleNavigation('/')}>
                            KADRAJ L'ATELIER
                        </span>
                        <div className="flex items-center">
                               <div className="relative">
                               <button onClick={() => setIsLangOpen(!isLangOpen)} className="flex items-center text-xs p-1">
                                   <span>{language === 'Türkçe' ? 'Türkçe' : language}</span>
                                   <ChevronDownIcon size={14} className="ml-1 text-gray-500" />
                               </button>
                               {isLangOpen && (
                                   <div className="absolute right-0 mt-2 w-32 bg-white rounded-md shadow-lg z-20 border">
                                       <a onClick={() => handleLangChange('Türkçe')} className="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 cursor-pointer">Türkçe</a>
                                       <a onClick={() => handleLangChange('English')} className="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 cursor-pointer">English</a>
                                       <a onClick={() => handleLangChange('Deutsch')} className="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 cursor-pointer">Deutsch</a>
                                   </div>
                               )}
                               </div>
                               <div className="relative ml-2">
                               <button onClick={() => setIsCurrencyOpen(!isCurrencyOpen)} className="flex items-center text-xs p-1">
                                   <span>{currency}</span>
                                   <ChevronDownIcon size={14} className="ml-1 text-gray-500" />
                               </button>
                               {isCurrencyOpen && (
                                   <div className="absolute right-0 mt-2 w-32 bg-white rounded-md shadow-lg z-20 border">
                                       <a onClick={() => handleCurrencyChange('TRY')} className="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 cursor-pointer">₺ TRY</a>
                                       <a onClick={() => handleCurrencyChange('USD')} className="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 cursor-pointer">$ USD</a>
                                       <a onClick={() => handleCurrencyChange('EUR')} className="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 cursor-pointer">€ EUR</a>
                                       <a onClick={() => handleCurrencyChange('GBP')} className="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 cursor-pointer">£ GBP</a>
                                   </div>
                               )}
                               </div>
                            <button onClick={() => setIsMobileMenuOpen(false)} className="text-gray-700 ml-2">
                                <XIcon size={24} />
                            </button>
                        </div>
                    </div>
                    <ul className="mt-4 space-y-1">
                        {menuItems.map((item) => (
                            <li key={item.key}>
                                <a onClick={() => handleNavigation(item.path)} className={`flex justify-between items-center py-2 text-base cursor-pointer ${item.key === 'outlet' ? 'text-red-600' : 'text-gray-800'} font-medium`}>
                                    <span>{t(item.key)}</span>
                                    <ChevronRightIcon size={20} className="text-gray-400" />
                                </a>
                            </li>
                        ))}
                    </ul>
                    <div className="mt-auto pt-4">
                        <div className="bg-gray-100 p-3 rounded-lg">
                            <ul className="space-y-2">
                            {utilityLinks.map((link) => {
                                const Icon = link.icon;
                                return (
                                <li key={link.key}>
                                    <a onClick={() => handleNavigation(link.path)} className={`flex items-center text-sm cursor-pointer ${link.key === 'kadrajSociety' ? 'text-red-700 font-bold' : 'text-gray-700 hover:text-black'}`}>
                                        <Icon size={18} className="mr-3 text-gray-600" />
                                        <span>{t(link.key)}</span>
                                    </a>
                                </li>
                                );
                            })}
                            </ul>
                        </div>
                    </div>
                </div>
            );
        };
        
        const SearchPanel = ({ t, setIsSearchOpen, setCurrentPath }) => {
            const [query, setQuery] = React.useState('');
            const [results, setResults] = React.useState([]);
            const [loading, setLoading] = React.useState(false);
            const [error, setError] = React.useState(null);

            React.useEffect(() => {
                if (query.trim() === '') {
                    setResults([]);
                    return;
                }
                const debounceTimer = setTimeout(() => {
                    const performSearch = async () => {
                        setLoading(true);
                        setError(null);
                        try {
                            const productsRef = window.collection(window.firebaseFirestore, 'products');
                            const querySnapshot = await window.getDocs(productsRef);
                            const allProducts = querySnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                            const lowercasedQuery = query.toLowerCase();
                            const filteredResults = allProducts.filter(product =>
                                (product.productName && product.productName.toLowerCase().includes(lowercasedQuery)) ||
                                (product.productDescription && product.productDescription.toLowerCase().includes(lowercasedQuery)) ||
                                (product.category && product.category.toLowerCase().includes(lowercasedQuery))
                            );
                            setResults(filteredResults);
                        } catch (err) {
                            console.error("Arama sırasında hata:", err);
                            setError("Arama yapılamadı. Lütfen daha sonra tekrar deneyin.");
                        } finally {
                            setLoading(false);
                        }
                    };
                    performSearch();
                }, 500);
                return () => clearTimeout(debounceTimer);
            }, [query]);

            const handleResultClick = (productId) => {
                setCurrentPath(`/products/${productId}`);
                setIsSearchOpen(false);
            };

            return (
                <div className="fixed top-0 left-0 w-full h-full bg-white z-50 flex flex-col items-center justify-start pt-20 md:pt-32 animate-fade-in-down">
                    <video src="search1.mp4" autoPlay loop muted playsInline className="absolute inset-0 w-full h-full object-cover z-0 opacity-20"></video>
                    <div className="container mx-auto px-6 md:px-10 relative z-10 flex flex-col items-center w-full">
                        <button onClick={() => setIsSearchOpen(false)} className="absolute top-[-4rem] right-0 md:top-[-5rem] text-gray-500 hover:text-gray-900 transition-colors duration-300">
                            <XIcon size={30} />
                        </button>
                        <div className="flex flex-col items-center w-full">
                            <input type="text" placeholder={t('searchProduct')} value={query} onChange={(e) => setQuery(e.target.value)} autoFocus className="w-full max-w-2xl text-center text-lg md:text-4xl border-b-2 border-gray-400 focus:border-gray-800 bg-transparent py-4 outline-none placeholder-gray-400 font-serif-new-roman" />
                            <div className="mt-4 flex space-x-2 md:mt-8 md:space-x-4">
                                <a href="#" className="text-sm md:text-lg font-bold text-gray-900 hover:underline">{t('new')}</a>
                                <a href="#" className="text-sm md:text-lg font-bold text-gray-900 hover:underline">{t('woman')}</a>
                                <a href="#" className="text-sm md:text-lg font-bold text-gray-900 hover:underline">{t('man')}</a>
                                <a href="#" className="text-sm md:text-lg font-bold text-gray-900 hover:underline">{t('child')}</a>
                                <a href="#" className="text-sm md:text-lg font-bold text-gray-900 hover:underline">{t('life')}</a>
                                <a href="#" className="text-sm md:text-lg font-bold text-gray-900 hover:underline">{t('brands')}</a>
                            </div>
                        </div>
                        <div className="mt-8 w-full max-w-3xl">
                            {loading && <p className="text-center text-gray-700 font-semibold">Aranıyor...</p>}
                            {error && <p className="text-center text-red-500">{error}</p>}
                            {!loading && results.length > 0 && (
                                <div className="bg-white bg-opacity-80 backdrop-blur-sm rounded-lg shadow-xl max-h-96 overflow-y-auto">
                                    <ul>
                                        {results.map(product => (
                                            <li key={product.id} onClick={() => handleResultClick(product.id)} className="cursor-pointer">
                                                <div className="flex items-center p-3 border-b border-gray-200 hover:bg-gray-100 transition-colors">
                                                    <img src={product.imageUrls?.[0] || 'https://via.placeholder.com/150'} alt={product.productName} className="w-16 h-16 object-cover rounded-md mr-4"/>
                                                    <div className="flex-grow">
                                                        <p className="font-bold text-gray-800">{product.productName}</p>
                                                        <p className="text-sm text-gray-600">{product.category}</p>
                                                    </div>
                                                    <p className="text-md font-semibold text-gray-800">{product.price} TRY</p>
                                                </div>
                                            </li>
                                        ))}
                                    </ul>
                                </div>
                            )}
                            {!loading && query.length > 2 && results.length === 0 && (
                                <p className="text-center text-gray-600 mt-4">"{query}" için sonuç bulunamadı.</p>
                            )}
                        </div>
                    </div>
                </div>
            );
        };

        const MobileBottomBar = ({ t, handleUserIconClick }) => {
            return (
                <div className="fixed bottom-0 left-0 w-full bg-white border-t border-gray-200 shadow-lg md:hidden z-40">
                    <div className="grid grid-cols-4 h-16">
                        <a href="#" className="flex flex-col items-center justify-center text-gray-500 hover:text-gray-900 transition-colors duration-300">
                            <HomeIcon size={24} className="mb-1" />
                            <span className="text-xs">{t('homeBar')}</span>
                        </a>
                        <a href="#" className="flex flex-col items-center justify-center text-gray-500 hover:text-gray-900 transition-colors duration-300">
                            <HeartIcon size={24} className="mb-1" />
                            <span className="text-xs">{t('favoritesBar')}</span>
                        </a>
                        <a href="#" className="flex flex-col items-center justify-center text-gray-500 hover:text-gray-900 transition-colors duration-300">
                            <ShoppingBagIcon size={24} className="mb-1" />
                            <span className="text-xs">{t('sepetimBar')}</span>
                        </a>
                        <a onClick={handleUserIconClick} className="flex flex-col items-center justify-center text-gray-500 hover:text-gray-900 transition-colors duration-300 cursor-pointer">
                            <UserIcon size={24} className="mb-1" />
                            <span className="text-xs">{t('hesabimBar')}</span>
                        </a>
                    </div>
                </div>
            );
        };
        const ScrollingBanner = ({ t }) => {
            const bannerContent = [ 'summerSale','newArrivals','raysDiscount', 'discoverThisWeeksHighlights', 'freeShipping' ];
            return (
                <div className="w-full bg-[#f2f4f7] text-gray-800 text-sm py-2 overflow-hidden relative">
                    <div className="flex whitespace-nowrap animate-scroll">
                        {bannerContent.map((key, index) => (<span key={index} className="px-8 flex-shrink-0 font-light text-[#222222]">{t(key)}</span>))}
                        {bannerContent.map((key, index) => (<span key={`duplicate-${index}`} className="px-8 flex-shrink-0 font-light text-[#222222]">{t(key)}</span>))}
                    </div>
                </div>
            );
        };
        const CategoriesMobile = ({ t }) => {
            const menuItems = [ 'allCategories', 'designers', 'seating', 'tables', 'lighting', 'rugs', 'decor', 'masters', 'shopByRoom', 'ourGalleries' ];
            return (
                <div className="md:hidden w-full overflow-x-scroll no-scrollbar py-4 border-b border-gray-200">
                    <ul className="flex space-x-6 px-4">
                        {menuItems.map((item, index) => (
                            <li key={index} className="flex-shrink-0">
                                <a href="#" className="font-normal hover:text-gray-900 transition duration-300 text-[13px] whitespace-nowrap">{t(item)}</a>
                            </li>
                        ))}
                        <li><a href="#" className="font-bold text-red-700 hover:text-gray-900 transition duration-300 text-[13px] whitespace-nowrap">{t('kadrajSociety')}</a></li>
                    </ul>
                </div>
            );
        };
        const CategoryHighlightSection = ({ t }) => {
            const categoryHighlights = [
                { name: t('lighting'), image: "lighting-main.png", bgColor: "bg-white" }, { name: t('armchairs'), image: "armchair-main.png", bgColor: "bg-white" },
                { name: t('tables'), image: "tables-main.png", bgColor: "bg-white" }, { name: t('rugs'), image: "rugs-main.png", bgColor: "bg-white" },
                { name: t('storage'), image: "storage-main.png", bgColor: "bg-white" }, { name: 'GIFTS', image: "gift-main.png", bgColor: "bg-neutral-200" },
            ];
            return (
                <div className="my-16 md:my-0">
                    <div className="grid grid-cols-3 md:grid-cols-6 gap-4 justify-around items-center px-4 md:px-0">
                        {categoryHighlights.map((category, index) => (
                            <div key={index} className="flex flex-col items-center">
                                <div className={`w-24 h-24 md:w-48 md:h-48 rounded-full flex items-center justify-center overflow-hidden mb-2 md:mb-4 ${category.bgColor}`}>
                                    <img src={category.image} alt={category.name} className="object-contain max-h-full max-w-full" />
                                </div>
                                <span className="text-xs md:text-base font-medium text-gray-800">{category.name}</span>
                            </div>
                        ))}
                    </div>
                </div>
            );
        };
        const HighlightsSection = ({ t }) => {
             const highlightItems = [
                { title: "inspiringBrands", subtitle: "dekoriGroup", image: "markalar.png", discoverText: "discover", position: "0% 0%" },
                { title: "perfectLiving", subtitle: "iconicTables", image: "tables.png", discoverText: "discover", position: "right 0" }
            ];
            return (
                <div className="container mx-auto mt-12 flex flex-col md:flex-row space-y-6 md:space-y-0 md:space-x-6">
                    {highlightItems.map((item, index) => (
                        <div key={index} className="flex-1 relative aspect-square overflow-hidden rounded-xl shadow-lg">
                            <div className="absolute inset-0 bg-cover bg-center" style={{ backgroundImage: `url(${item.image})`, backgroundPosition: item.position }}></div>
                            <div className="absolute inset-0 bg-black bg-opacity-40 flex flex-col items-start justify-end p-8 text-white">
                                <p className="text-xs font-semibold tracking-widest mb-2">{t(item.title)}</p>
                                <h3 className="text-3xl font-bold mb-4">{t(item.subtitle)}</h3>
                                <a href="#" className="flex items-center text-sm font-bold tracking-wider">
                                    {t(item.discoverText)}
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="ml-2"><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></svg>
                                </a>
                            </div>
                        </div>
                    ))}
                </div>
            );
        };
        const ProductCard = ({ imageSrc, category }) => {
            return (
                <div className="flex-none w-[200px] bg-white rounded-lg overflow-hidden flex flex-col items-center p-4">
                    <div className="w-full aspect-w-3 aspect-h-4 mb-4"><img src={imageSrc} alt={category} className="w-full h-full object-cover" /></div>
                    <p className="text-xs font-normal text-gray-500 uppercase tracking-widest">{category}</p>
                </div>
            );
        };
        const NewInSection = ({ t }) => {
            const productCategories = [
                { id: 'decor', image: 'dekor.png', category: t('decor') }, { id: 'lighting', image: 'lighting.png', category: t('lighting') },
                { id: 'rugs', image: 'rugs.png', category: t('rugs') }, { id: 'armchairs', image: 'armchair.png', category: t('armchairs') },
            ];
            const scrollRef = React.useRef(null);
            const scroll = (scrollOffset) => {
                if (scrollRef.current) { scrollRef.current.scrollBy({ left: scrollOffset, behavior: 'smooth' }); }
            };
            return (
                <div className="flex flex-col md:flex-row justify-between items-center bg-white p-8 my-8">
                    <div className="w-full md:w-1/4 pr-8 mb-8 md:mb-0">
                        <h2 className="text-4xl font-normal tracking-normal mb-4 font-serif-new-roman">{t('newIn')}</h2>
                        <p className="text-sm font-light text-gray-600 mb-6">{t('newInDesc')}</p>
                        <button className="bg-black text-white px-8 py-3 text-sm font-bold tracking-wider hover:bg-gray-800 transition-colors duration-300">{t('shopNewIn')}</button>
                    </div>
                    <div className="w-full md:w-3/4 relative flex items-center">
                        <button onClick={() => scroll(-250)} className="absolute left-0 z-10 bg-white rounded-full p-2 shadow-md hover:bg-gray-100 transition-colors duration-300">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M15 18l-6-6 6-6"/></svg>
                        </button>
                        <div ref={scrollRef} className="flex overflow-x-scroll no-scrollbar space-x-6 px-2">
                            {productCategories.map((product, index) => (<ProductCard key={index} imageSrc={product.image} category={product.category} />))}
                        </div>
                        <button onClick={() => scroll(250)} className="absolute right-0 z-10 bg-white rounded-full p-2 shadow-md hover:bg-gray-100 transition-colors duration-300">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M9 18l6-6-6-6"/></svg>
                        </button>
                    </div>
                </div>
            );
        };
        const TradeProgramSection = ({ t, setCurrentPath }) => {
            const features = [
                { title: t('curatedSelections'), description: t('curatedSelectionsDesc'), image: "kuratorlu-secki.jpg" },
                { title: t('directArtistSupport'), description: t('directArtistSupportDesc'), image: "sanatci-destek.jpg" },
                { title: t('securePayment'), description: t('securePaymentProcess'), image: "guvenli-odeme.jpg" },
                { title: t('expertAdviserTeam'), description: t('expertAdviserTeamDesc'), image: "danisan-ekip.jpg" },
            ];
            return (
                <div className="my-16">
                    <div className="bg-[#fcf5f6] p-12 text-center flex flex-col items-center justify-center mb-12">
                        <h3 className="text-4xl font-normal font-serif-new-roman mb-6 text-gray-800">{t('wantToBeDesigner')}</h3>
                        <button onClick={() => setCurrentPath('/seller-register')} className="bg-black text-white px-8 py-3 text-sm font-bold tracking-wider hover:bg-gray-800 transition-colors duration-300">
                            {t('joinNow')}
                        </button>
                    </div>
                    <div className="grid grid-cols-2 md:grid-cols-4 gap-8 md:gap-4 justify-around items-start text-center">
                        {features.map((feature, index) => (
                            <div key={index} className="w-full px-2">
                                <div className="relative w-full aspect-square mb-4 mx-auto transform scale-70">
                                    <img src={feature.image} alt={feature.title} className="absolute inset-0 w-full h-full object-cover" />
                                </div>
                                <h4 className="text-lg font-bold mb-2">{feature.title}</h4>
                                <p className="text-sm text-gray-600 leading-relaxed">{feature.description}</p>
                            </div>
                        ))}
                    </div>
                </div>
            );
        };
        const Footer = ({ t }) => {
            return (
                <footer className="bg-white border-t border-gray-200 mt-20 py-12 px-6 md:px-10">
                    <div className="container mx-auto">
                        <div className="grid grid-cols-1 md:grid-cols-4 gap-12 text-gray-800">
                            <div>
                                <h4 className="font-bold text-sm tracking-wide uppercase mb-4">{t('shopBy')}</h4>
                                <ul className="space-y-2 text-sm text-gray-600">
                                    <li><a href="#" className="hover:text-gray-900 transition-colors">{t('seating')}</a></li>
                                    <li><a href="#" className="hover:text-gray-900 transition-colors">{t('tables')}</a></li>
                                    <li><a href="#" className="hover:text-gray-900 transition-colors">{t('lighting')}</a></li>
                                    <li><a href="#" className="hover:text-gray-900 transition-colors">{t('rugs')}</a></li>
                                    <li><a href="#" className="hover:text-gray-900 transition-colors">{t('storage')}</a></li>
                                    <li><a href="#" className="hover:text-gray-900 transition-colors">{t('décor')}</a></li>
                                    <li><a href="#" className="hover:text-gray-900 transition-colors">{t('gifts')}</a></li>
                                </ul>
                            </div>
                            <div>
                                <h4 className="font-bold text-sm tracking-wide uppercase mb-4">{t('services')}</h4>
                                <ul className="space-y-2 text-sm text-gray-600 mb-6">
                                    <li><a href="#" className="hover:text-gray-900 transition-colors">{t('appointmentBooking')}</a></li>
                                    <li><a href="#" className="hover:text-gray-900 transition-colors">{t('tradeProgram')}</a></li>
                                    <li><a href="#" className="hover:text-gray-900 transition-colors">{t('internationalDeliveries')}</a></li>
                                    <li><a href="#" className="hover:text-gray-900 transition-colors">{t('paymentMethods')}</a></li>
                                </ul>
                                <h4 className="font-bold text-sm tracking-wide uppercase mb-4">{t('followUs')}</h4>
                                <ul className="space-y-2 text-sm text-gray-600">
                                    <li><a href="#" className="hover:text-gray-900 transition-colors">{t('pinterest')}</a></li>
                                    <li><a href="#" className="hover:text-gray-900 transition-colors">{t('instagram')}</a></li>
                                    <li><a href="#" className="hover:text-gray-900 transition-colors">{t('linkedin')}</a></li>
                                    <li><a href="#" className="hover:text-gray-900 transition-colors">{t('youtube')}</a></li>
                                </ul>
                            </div>
                            <div>
                                <h4 className="font-bold text-sm tracking-wide uppercase mb-4">{t('about')}</h4>
                                <ul className="space-y-2 text-sm text-gray-600">
                                    <li><a href="#" className="hover:text-gray-900 transition-colors">{t('aboutUs')}</a></li>
                                    <li><a href="#" className="hover:text-gray-900 transition-colors">{t('theTeam')}</a></li>
                                    <li><a href="#" className="hover:text-gray-900 transition-colors">{t('ourValues')}</a></li>
                                    <li><a href="#" className="hover:text-gray-900 transition-colors">{t('ourGalleries')}</a></li>
                                    <li><a href="#" className="hover:text-gray-900 transition-colors">{t('catalogs')}</a></li>
                                    <li><a href="#" className="hover:text-gray-900 transition-colors">{t('bCorp')}</a></li>
                                    <li><a href="#" className="hover:text-gray-900 transition-colors">{t('inspirations')}</a></li>
                                    <li><a href="#" className="hover:text-gray-900 transition-colors">{t('press')}</a></li>
                                    <li><a href="#" className="hover:text-gray-900 transition-colors">{t('podcast')}</a></li>
                                    <li><a href="#" className="hover:text-gray-900 transition-colors">{t('howTo')}</a></li>
                                    <li><a href="#" className="hover:text-gray-900 transition-colors">{t('careers')}</a></li>
                                    <li><a href="#" className="hover:text-gray-900 transition-colors">{t('legalNotice')}</a></li>
                                    <li><a href="#" className="hover:text-gray-900 transition-colors">{t('privacyPolicy')}</a></li>
                                </ul>
                            </div>
                            <div className="flex flex-col">
                                <h4 className="font-bold text-sm tracking-wide uppercase mb-4">{t('subscribeToNewsletter')}</h4>
                                <form className="flex w-full mb-8">
                                    <input type="email" placeholder="Email" className="w-full p-3 border border-gray-300 focus:outline-none focus:border-gray-500 text-sm" />
                                    <button type="submit" className="bg-gray-800 text-white font-bold text-xs tracking-wider uppercase px-6 py-3 hover:bg-gray-700 transition-colors">
                                        {t('subscribe')}
                                    </button>
                                </form>
                                <div className="flex flex-col space-y-4">
                                    <div className="flex items-start space-x-4">
                                        <div className="text-right">
                                            <p className="text-xs font-semibold">{t('proudToBeBCorp')}</p>
                                            <p className="text-[11px] text-gray-500 leading-tight">{t('bCorpDescription')}</p>
                                        </div>
                                        <img src="b-corp-logo.png" alt="Certified B Corporation" className="h-16 md:h-20" />
                                    </div>
                                    <div className="flex items-center justify-end">
                                        <img src="monocle-logo.png" alt="Monocle" className="h-8 md:h-10" />
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div className="mt-16 pt-8 border-t border-gray-200 flex flex-col md:flex-row justify-between items-center text-sm text-gray-500">
                            <div className="text-center md:text-left mb-4 md:mb-0">
                                &copy; 2025 The Invisible Collection Ltd.<br/>{t('allRightsReserved')}
                            </div>
                            <div className="flex space-x-4 items-center flex-wrap justify-center">
                                <img src="visa-logo.png" alt="Visa" className="h-4 md:h-6" />
                                <img src="amex-logo.png" alt="American Express" className="h-4 md:h-6" />
                                <img src="apple-pay-logo.png" alt="Apple Pay" className="h-4 md:h-6" />
                                <img src="paypal-logo.png" alt="PayPal" className="h-4 md:h-6" />
                                <img src="klarna-logo.png" alt="Klarna" className="h-4 md:h-6" />
                                <img src="b-pay-logo.png" alt="B-Pay" className="h-4 md:h-6" />
                            </div>
                        </div>
                    </div>
                </footer>
            );
        };

        // Page Components
        const HomePage = ({ setCurrentPath, t }) => {
            const images = [ "kadraj-slide1.png", "kadraj-slide2.png", "kadraj-slide3.png" ];
            const [currentSlide, setCurrentSlide] = React.useState(0);
            const nextSlide = () => setCurrentSlide((prev) => (prev + 1) % images.length);
            const prevSlide = () => setCurrentSlide((prev) => (prev - 1 + images.length) % images.length);
            React.useEffect(() => {
                const slideInterval = setInterval(nextSlide, 7000);
                return () => clearInterval(slideInterval);
            }, []);
            return (
                <>
                    <div className="flex flex-col md:flex-row mt-0 gap-0 border-0">
                        <div className="relative w-full md:w-1/3 aspect-[9/10] overflow-hidden">
                            <video src="loop1.mp4" autoPlay loop muted playsInline className="w-full h-full object-cover"></video>
                            <div className="absolute inset-0 bg-black bg-opacity-30 flex flex-col items-start justify-end p-8 text-white">
                                <p className="text-xs font-normal tracking-widest mb-2">{t('editorSelection')}<span className="italic font-bold">{t('summer')}</span>{t('selection')}</p>
                                <h3 className="text-4xl font-bold mb-4">{t('laclaud')}</h3>
                                <a href="#" className="flex items-center text-sm font-bold tracking-wider">
                                    {t('discover')}
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="ml-2"><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></svg>
                                </a>
                            </div>
                        </div>
                        <div className="relative w-full md:w-2/3 aspect-[16/9] overflow-hidden">
                            <div className="absolute top-0 left-0 w-[300%] h-full flex transition-transform duration-500 ease-in-out" style={{ transform: `translateX(-${currentSlide * 100 / images.length}%)` }}>
                                {images.map((image, index) => (
                                    <div key={index} className="w-1/3 h-full flex-shrink-0">
                                        <img src={image} alt={`Slide ${index}`} className="w-full h-full object-cover" />
                                    </div>
                                ))}
                            </div>
                            <button onClick={prevSlide} className="absolute left-4 top-1/2 -translate-y-1/2 z-10 bg-white rounded-full p-2 shadow-md hover:bg-gray-100 transition-colors duration-300">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M15 18l-6-6 6-6"/></svg>
                            </button>
                            <button onClick={nextSlide} className="absolute right-4 top-1/2 -translate-y-1/2 z-10 bg-white rounded-full p-2 shadow-md hover:bg-gray-100 transition-colors duration-300">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M9 18l6-6-6-6"/></svg>
                            </button>
                            <div className="absolute bottom-4 left-1/2 -translate-x-1/2 flex space-x-2 z-10">
                                {images.map((_, index) => (
                                    <button key={index} onClick={() => setCurrentSlide(index)} className={`h-2 w-2 rounded-full transition-colors duration-300 ${currentSlide === index ? 'bg-black' : 'bg-gray-300'}`}></button>
                                ))}
                            </div>
                        </div>
                    </div>
                    <CategoryHighlightSection t={t} />
                    <HighlightsSection t={t} />
                    <NewInSection t={t} />
                    <TradeProgramSection t={t} setCurrentPath={setCurrentPath} />
                </>
            );
        };
        const LoginPage = ({ setCurrentPath, t }) => {
             const [email, setEmail] = React.useState('');
            const [password, setPassword] = React.useState('');
            const [loginError, setLoginError] = React.useState('');
            const handleLogin = async (e) => {
                e.preventDefault();
                setLoginError('');
                try {
                    const userCredential = await window.signInWithEmailAndPassword(window.firebaseAuth, email, password);
                    const user = userCredential.user;
                    const userDocRef = window.doc(window.firebaseFirestore, 'users', user.uid);
                    const userDocSnap = await window.getDoc(userDocRef);
                    if (userDocSnap.exists()) {
                        const userData = userDocSnap.data();
                        if (userData.role === 'seller') {
                            window.location.href = 'seller-dashboard.html';
                        } else if (userData.role === 'admin') {
                            window.location.href = 'admin-dashboard.html';
                        } else {
                            setCurrentPath('/user-dashboard');
                        }
                    } else {
                        setCurrentPath('/user-dashboard');
                    }
                } catch (error) {
                    console.error("Login error:", error);
                    setLoginError(t('invalidCredentials'));
                }
            };
            return (
                <div className="flex items-center justify-center min-h-[calc(100vh-160px)]">
                    <div className="bg-white p-8 rounded-xl shadow-lg border border-gray-100 w-full max-w-md">
                        <h2 className="text-3xl font-bold text-gray-900 mb-6 text-center">{t('login')}</h2>
                        <form onSubmit={handleLogin} className="space-y-5">
                            <Input label={t('email')} type="email" value={email} onChange={(e) => setEmail(e.target.value)} placeholder="ornek@mail.com" />
                            <Input label={t('password')} type="password" value={password} onChange={(e) => setPassword(e.target.value)} placeholder="********" />
                            {loginError && (<p className="text-red-500 text-sm text-center">{loginError}</p>)}
                            <button type="submit" className="w-full bg-gray-800 text-white py-3 px-4 rounded-lg hover:bg-gray-900 transition duration-300 ease-in-out shadow-md text-lg">{t('login')}</button>
                        </form>
                        <div className="mt-8 text-center space-y-4">
                            <p className="text-gray-600 text-sm">
                                {t('noAccount')}{' '}
                                <button onClick={() => setCurrentPath('/register')} className="text-blue-600 hover:underline font-semibold">{t('signUp')}</button>
                            </p>
                            <p className="text-gray-700">
                                <button onClick={() => setCurrentPath('/seller-register')} className="text-gray-700 hover:underline font-semibold">{t('wantToBeDesigner')}</button>
                            </p>
                        </div>
                    </div>
                </div>
            );
        };
        const UserRegisterPage = ({ setCurrentPath, t }) => {
            const [fullName, setFullName] = React.useState('');
            const [email, setEmail] = React.useState('');
            const [password, setPassword] = React.useState('');
            const [confirmPassword, setConfirmPassword] = React.useState('');
            const [registerError, setRegisterError] = React.useState('');
            const [registerSuccess, setRegisterSuccess] = React.useState(false);
            const handleRegister = async (e) => {
                e.preventDefault();
                setRegisterError('');
                if (password !== confirmPassword) {
                    setRegisterError(t('passwordsMismatch'));
                    return;
                }
                try {
                    const userCredential = await window.createUserWithEmailAndPassword(window.firebaseAuth, email, password);
                    const user = userCredential.user;
                    await window.setDoc(window.doc(window.firebaseFirestore, 'users', user.uid), {
                        role: 'user', email: email, fullName: fullName
                    });
                    setRegisterSuccess(true);
                } catch (error) {
                    console.error("Registration error:", error);
                    if (error.code === 'auth/email-already-in-use') {
                        setRegisterError("Bu e-posta adresi zaten kullanımda.");
                    } else if (error.code === 'auth/weak-password') {
                        setRegisterError("Şifre en az 6 karakter olmalıdır.");
                    } else {
                        setRegisterError(t('genelHata'));
                    }
                }
            };
            return (
                <div className="flex items-center justify-center min-h-[calc(100vh-160px)]">
                    <div className="bg-white p-8 rounded-xl shadow-lg border border-gray-100 w-full max-w-lg">
                        <h2 className="text-3xl font-bold text-gray-900 mb-6 text-center">{t('userRegistration')}</h2>
                        {registerSuccess ? (
                            <div className="text-center text-green-600 font-semibold text-xl py-8">
                                <p>{t('registrationSuccess')}</p>
                                <p className="text-base font-normal text-gray-600 mt-2">{t('canNowLogin')}</p>
                                <button onClick={() => setCurrentPath('/login')} className="mt-6 bg-gray-800 text-white py-2 px-4 rounded-lg hover:bg-gray-900 transition duration-300 ease-in-out shadow-md">{t('backToLogin')}</button>
                            </div>
                        ) : (
                            <form onSubmit={handleRegister} className="space-y-5">
                                <Input label={t('fullName')} value={fullName} onChange={(e) => setFullName(e.target.value)} placeholder={t('fullName')} />
                                <Input label={t('email')} type="email" value={email} onChange={(e) => setEmail(e.target.value)} placeholder="ornek@mail.com" />
                                <Input label={t('password')} type="password" value={password} onChange={(e) => setPassword(e.target.value)} placeholder="********" />
                                <Input label={t('confirmPassword')} type="password" value={confirmPassword} onChange={(e) => setConfirmPassword(e.target.value)} placeholder="********" />
                                {registerError && (<p className="text-red-500 text-sm text-center">{registerError}</p>)}
                                <button type="submit" className="w-full bg-gray-800 text-white py-3 px-4 rounded-lg hover:bg-gray-900 transition duration-300 ease-in-out shadow-md text-lg">{t('createAccount')}</button>
                            </form>
                        )}
                        <div className="mt-6 text-center">
                            <p className="text-gray-700 text-sm">
                                {t('alreadyHaveAccount')}{' '}
                                <button onClick={() => setCurrentPath('/login')} className="text-blue-600 hover:underline font-semibold">{t('login')}</button>
                            </p>
                        </div>
                    </div>
                </div>
            );
        };
        const SellerRegisterPage = ({ setCurrentPath, t }) => {
            const [atelierName, setAtelierName] = React.useState('');
            const [fullName, setFullName] = React.useState('');
            const [email, setEmail] = React.useState('');
            const [password, setPassword] = React.useState('');
            const [confirmPassword, setConfirmPassword] = React.useState('');
            const [portfolioLink, setPortfolioLink] = React.useState('');
            const [shortDescription, setShortDescription] = React.useState('');
            const [registerError, setRegisterError] = React.useState('');
            const [registerSuccess, setRegisterSuccess] = React.useState(false);
            const handleRegister = async (e) => {
                e.preventDefault();
                setRegisterError('');
                if (password !== confirmPassword) {
                    setRegisterError(t('passwordsMismatch')); return;
                }
                try {
                    const userCredential = await window.createUserWithEmailAndPassword(window.firebaseAuth, email, password);
                    const user = userCredential.user;
                    await window.setDoc(window.doc(window.firebaseFirestore, 'users', user.uid), {
                        role: 'seller', email, atelierName, fullName, portfolioLink, shortDescription, status: 'pending'
                    });
                    setRegisterSuccess(true);
                } catch (error) {
                    console.error("Registration error:", error);
                    if (error.code === 'auth/email-already-in-use') {
                        setRegisterError("Bu e-posta adresi zaten kullanımda.");
                    } else if (error.code === 'auth/weak-password') {
                        setRegisterError("Şifre en az 6 karakter olmalıdır.");
                    } else {
                        setRegisterError(t('genelHata'));
                    }
                }
            };
            return (
                <div className="flex items-center justify-center min-h-[calc(100vh-160px)]">
                    <div className="bg-white p-8 rounded-xl shadow-lg border border-gray-100 w-full max-w-lg">
                        <h2 className="text-3xl font-bold text-gray-900 mb-6 text-center">{t('atelierPartnershipApplication')}</h2>
                        {registerSuccess ? (
                            <div className="text-center text-green-600 font-semibold text-xl py-8">
                                <p>{t('applicationReceived')}</p>
                                <p className="text-base font-normal text-gray-600 mt-2">{t('contactSoon')}</p>
                                <button onClick={() => setCurrentPath('/login')} className="mt-6 bg-gray-800 text-white py-2 px-4 rounded-lg hover:bg-gray-900 transition duration-300 ease-in-out shadow-md">{t('backToLogin')}</button>
                            </div>
                        ) : (
                            <form onSubmit={handleRegister} className="space-y-5">
                                <Input label={t('atelierName')} value={atelierName} onChange={(e) => setAtelierName(e.target.value)} />
                                <Input label={t('fullName')} value={fullName} onChange={(e) => setFullName(e.target.value)} />
                                <Input label={t('email')} type="email" value={email} onChange={(e) => setEmail(e.target.value)} />
                                <Input label={t('password')} type="password" value={password} onChange={(e) => setPassword(e.target.value)} />
                                <Input label={t('confirmPassword')} type="password" value={confirmPassword} onChange={(e) => setConfirmPassword(e.target.value)} />
                                <Input label={t('portfolioLink')} value={portfolioLink} onChange={(e) => setPortfolioLink(e.target.value)} />
                                <TextArea label={t('shortDescription')} value={shortDescription} onChange={(e) => setShortDescription(e.target.value)} />
                                {registerError && (<p className="text-red-500 text-sm text-center">{registerError}</p>)}
                                <button type="submit" className="w-full bg-gray-800 text-white py-3 px-4 rounded-lg hover:bg-gray-900 transition duration-300 ease-in-out shadow-md text-lg">{t('submitApplication')}</button>
                            </form>
                        )}
                        <div className="mt-6 text-center">
                            <p className="text-gray-700 text-sm">
                                {t('alreadyHaveAccount')}{' '}
                                <button onClick={() => setCurrentPath('/login')} className="text-blue-600 hover:underline font-semibold">{t('login')}</button>
                            </p>
                        </div>
                    </div>
                </div>
            );
        };
        
        // --- NEW/UPDATED USER DASHBOARD COMPONENTS ---
        
        // Mock data for demonstration
        const mockOrders = [
            { id: 'KDRJ-789123', date: '01.07.2025', product: 'Iroko Ahşap Sandalye', status: 'completed', image: 'armchair.png', price: '3.450' },
            { id: 'KDRJ-789124', date: '15.06.2025', product: 'Pirinç Detaylı Lamba', status: 'inTransit', image: 'lighting.png', price: '1.800' },
            { id: 'KDRJ-789125', date: '02.04.2025', product: 'El Dokuması Halı', status: 'cancelled', image: 'rugs.png', price: '4.900' },
        ];
        
        const DashboardSection = ({ title, children }) => (
            <div className="bg-white p-6 md:p-8 rounded-lg shadow-sm">
                <h3 className="text-2xl font-semibold text-gray-800 mb-6 pb-4 border-b">{title}</h3>
                {children}
            </div>
        );

        const MyOrdersSection = ({ t, currency }) => {
            const getStatusClass = (status) => {
                switch(status) {
                    case 'completed': return 'bg-green-100 text-green-800';
                    case 'inTransit': return 'bg-blue-100 text-blue-800';
                    case 'cancelled': return 'bg-red-100 text-red-800';
                    default: return 'bg-gray-100 text-gray-800';
                }
            };
            return (
                <DashboardSection title={t('myOrders')}>
                    <div className="space-y-6">
                        {mockOrders.map(order => (
                            <div key={order.id} className="flex flex-col md:flex-row items-start md:items-center p-4 border rounded-lg hover:shadow-md transition-shadow">
                                <img src={order.image} alt={order.product} className="w-24 h-24 object-cover rounded-md mb-4 md:mb-0 md:mr-6" />
                                <div className="flex-grow space-y-2">
                                    <p className="font-bold text-lg text-gray-800">{order.product}</p>
                                    <p className="text-sm text-gray-500">{t('orderId')} {order.id}</p>
                                    <p className="text-sm text-gray-500">{t('date')} {order.date}</p>
                                </div>
                                <div className="flex flex-col items-start md:items-end mt-4 md:mt-0 space-y-3">
                                    <p className="font-semibold text-lg">{order.price} {currency}</p>
                                    <span className={`px-3 py-1 text-xs font-medium rounded-full ${getStatusClass(order.status)}`}>{t(order.status)}</span>
                                    <button className="text-sm text-blue-600 hover:underline">{t('messageDesigner')}</button>
                                </div>
                            </div>
                        ))}
                    </div>
                </DashboardSection>
            );
        };

        const FavoritesSection = ({ t }) => {
            const [activeTab, setActiveTab] = React.useState('designs');
            return (
                <DashboardSection title={t('favorites')}>
                    <div className="flex border-b mb-6">
                        <button onClick={() => setActiveTab('designs')} className={`py-2 px-4 text-sm font-medium ${activeTab === 'designs' ? 'border-b-2 border-gray-800 text-gray-800' : 'text-gray-500'}`}>{t('favoriteDesigns')}</button>
                        <button onClick={() => setActiveTab('ateliers')} className={`py-2 px-4 text-sm font-medium ${activeTab === 'ateliers' ? 'border-b-2 border-gray-800 text-gray-800' : 'text-gray-500'}`}>{t('favoriteAteliers')}</button>
                    </div>
                    <div>
                        {activeTab === 'designs' && <p>Favori tasarımlarınız burada listelenecek.</p>}
                        {activeTab === 'ateliers' && <p>Favori atölyeleriniz burada listelenecek.</p>}
                    </div>
                </DashboardSection>
            );
        };
        
        const ProfileManagementSection = ({ t, currentUser }) => (
            <DashboardSection title={t('profileManagement')}>
                <div className="space-y-6 max-w-lg">
                    <Input label={t('fullName')} type="text" value={currentUser?.displayName || 'Ahmet Yılmaz'} />
                    <Input label={t('email')} type="email" value={currentUser?.email} disabled />
                    <button className="w-full bg-gray-800 text-white py-2 px-4 rounded-lg hover:bg-gray-900 transition">{t('saveBillingInfo')}</button>
                </div>
            </DashboardSection>
        );

        const DeliveryAddressesSection = ({ t }) => (
            <DashboardSection title={t('deliveryAddresses')}>
                 <div className="space-y-6 max-w-lg">
                    <Input label={t('addressTitle')} type="text" placeholder="Ev Adresim"/>
                    <Input label={t('addressLine1')} type="text" placeholder="Cadde, sokak, mahalle bilgileri..."/>
                    <Input label={t('addressLine2')} type="text" placeholder="Bina, daire no..."/>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <Input label={t('city')} type="text" placeholder="İstanbul"/>
                        <Input label={t('district')} type="text" placeholder="Kadıköy"/>
                    </div>
                    <button className="w-full bg-gray-800 text-white py-2 px-4 rounded-lg hover:bg-gray-900 transition">{t('saveAddress')}</button>
                 </div>
            </DashboardSection>
        );

        const BillingInformationSection = ({ t }) => (
              <DashboardSection title={t('billingInformation')}>
                   <div className="space-y-6 max-w-lg">
                        <Input label={t('nameSurnameCompanyName')} type="text" placeholder="Ahmet Yılmaz"/>
                        <Input label={t('tcIdTaxNo')} type="text" placeholder="12345678901"/>
                        {/* Re-use address fields or a component */}
                        <button className="w-full bg-gray-800 text-white py-2 px-4 rounded-lg hover:bg-gray-900 transition">{t('saveBillingInfo')}</button>
                   </div>
            </DashboardSection>
        );


        const UserDashboard = ({ setCurrentPath, t, currentUser, currency }) => {
            const [activeView, setActiveView] = React.useState('myOrders');
            
            const handleLogout = () => {
                window.signOut(window.firebaseAuth).then(() => {
                    setCurrentPath('/');
                }).catch((error) => {
                    console.error('Logout Error:', error);
                });
            };
            
            const menuItems = [
                { id: 'myOrders', label: t('myOrders'), icon: FileTextIcon },
                { id: 'favorites', label: t('favorites'), icon: HeartIcon },
                { id: 'profileManagement', label: t('profileManagement'), icon: UserIcon },
                { id: 'deliveryAddresses', label: t('deliveryAddresses'), icon: MapPinIcon },
                { id: 'billingInformation', label: t('billingInformation'), icon: CreditCardIcon },
            ];

            const renderContent = () => {
                switch(activeView) {
                    case 'myOrders': return <MyOrdersSection t={t} currency={currency} />;
                    case 'favorites': return <FavoritesSection t={t} />;
                    case 'profileManagement': return <ProfileManagementSection t={t} currentUser={currentUser} />;
                    case 'deliveryAddresses': return <DeliveryAddressesSection t={t} />;
                    case 'billingInformation': return <BillingInformationSection t={t} />;
                    default: return <MyOrdersSection t={t} currency={currency} />;
                }
            };
            
            return (
                <div className="container mx-auto">
                      <h2 className="text-3xl md:text-4xl font-light text-gray-800 mb-8">{t('collectorPanel')}</h2>
                      <div className="flex flex-col md:flex-row gap-8">
                            {/* --- Left Sidebar --- */}
                            <aside className="w-full md:w-1/4 lg:w-1/5">
                                <nav className="flex flex-col space-y-2">
                                    {menuItems.map(item => {
                                        const Icon = item.icon;
                                        return (
                                            <button 
                                                key={item.id}
                                                onClick={() => setActiveView(item.id)}
                                                className={`flex items-center p-3 rounded-lg text-left transition-colors text-sm font-medium ${activeView === item.id ? 'bg-gray-800 text-white shadow' : 'text-gray-600 hover:bg-gray-100'}`}
                                            >
                                                <Icon size={20} className="mr-3" />
                                                {item.label}
                                            </button>
                                        );
                                    })}
                                    <button
                                        onClick={handleLogout}
                                        className="flex items-center p-3 mt-4 rounded-lg text-left transition-colors text-sm font-medium text-gray-600 hover:bg-gray-100"
                                    >
                                        <LogOutIcon size={20} className="mr-3" />
                                        {t('logout')}
                                    </button>
                                </nav>
                            </aside>
                            {/* --- Right Content --- */}
                            <main className="w-full md:w-3/4 lg:w-4/5">
                                {renderContent()}
                            </main>
                       </div>
                </div>
            );
        };
        
        // --- YENİ ÜRÜN DETAY SAYFASI BİLEŞENİ ---
        const ProductPage = ({ productId, setCurrentPath, t, currency }) => {
            const [product, setProduct] = React.useState(null);
            const [loading, setLoading] = React.useState(true);
            const [error, setError] = React.useState(null);
            const [activeImage, setActiveImage] = React.useState(0);
            const [activeTab, setActiveTab] = React.useState('description');

            React.useEffect(() => {
                const fetchProduct = async () => {
                    setLoading(true);
                    try {
                        const productRef = window.doc(window.firebaseFirestore, 'products', productId);
                        const docSnap = await window.getDoc(productRef);

                        if (docSnap.exists()) {
                            setProduct({ id: docSnap.id, ...docSnap.data() });
                        } else {
                            setError("Ürün bulunamadı.");
                        }
                    } catch (err) {
                        console.error("Ürün detayı çekilirken hata:", err);
                        setError("Ürün bilgileri alınırken bir hata oluştu.");
                    } finally {
                        setLoading(false);
                    }
                };

                fetchProduct();
            }, [productId]);

            if (loading) {
                return <div className="text-center py-20 text-lg font-semibold">Ürün Bilgileri Yükleniyor...</div>;
            }

            if (error) {
                return <div className="text-center py-20 text-red-600 font-semibold">{error}</div>;
            }

            if (!product) {
                return null; // Veya bir "ürün yok" bileşeni
            }

            const tabs = [
                { id: 'description', label: t('productDescription') },
                { id: 'story', label: t('productStory') },
                { id: 'details', label: t('materialInfo') },
                { id: 'shipping', label: t('shippingInfo') },
            ];

            return (
                <div className="container mx-auto mt-8">
                    <div className="flex flex-col md:flex-row gap-10 lg:gap-16">
                        
                        {/* SOL TARAF: GÜNCELLENMİŞ RESİM/VİDEO GALERİSİ */}
                        <div className="w-full md:w-1/2">
                            <div className="aspect-square bg-gray-100 rounded-lg overflow-hidden mb-4 shadow-lg">
                                {product.videoUrl ? (
                                    <video
                                        key={product.videoUrl}
                                        src={product.videoUrl}
                                        controls
                                        autoPlay
                                        muted
                                        loop
                                        className="w-full h-full object-cover"
                                    >
                                        Tarayıcınız video etiketini desteklemiyor.
                                    </video>
                                ) : (
                                    <img 
                                        src={product.imageUrls?.[activeImage] || 'https://via.placeholder.com/600'} 
                                        alt={product.productName} 
                                        className="w-full h-full object-cover" 
                                    />
                                )}
                            </div>
                            <div className="grid grid-cols-5 gap-2">
                                {product.imageUrls?.map((url, index) => (
                                    <div key={index} 
                                         className={`aspect-square bg-gray-100 rounded-md overflow-hidden cursor-pointer border-2 transition-all duration-200 ${activeImage === index ? 'border-gray-800 shadow-md' : 'border-transparent'}`}
                                         onClick={() => setActiveImage(index)}>
                                        <img src={url} alt={`${product.productName} - ${index + 1}`} className="w-full h-full object-cover"/>
                                    </div>
                                ))}
                            </div>
                        </div>

                        {/* SAĞ TARAF: ÜRÜN BİLGİLERİ (TÜM ALANLAR GÜNCELLENDİ) */}
                        <div className="w-full md:w-1/2" data-product-id={product.id}>
                            <a href={`\/category\/${(product.categorySlug || product.category || "").toLowerCase()}`} data-category={(product.categorySlug || product.category)} className="text-sm font-semibold text-gray-500 uppercase underline underline-offset-4 hover:text-gray-700 transition">{product.category}</a>
                            <h1 className="text-4xl lg:text-5xl font-bold text-gray-900 my-3">{product.productName}</h1>
                            <p className="text-3xl text-gray-800 mb-6">{product.price} {currency}</p>
                            
                            <div className="flex flex-col sm:flex-row gap-4 mb-8">
                                <button data-add-to-cart="true" className="w-full bg-gray-800 text-white py-3 px-6 rounded-lg hover:bg-gray-900 transition flex items-center justify-center gap-2 font-bold">
                                    <ShoppingBagIcon size={20} />
                                    Sepete Ekle
                                </button>
                                <button data-toggle-favorite="true" className="w-full sm:w-auto border border-gray-300 text-gray-800 py-3 px-6 rounded-lg hover:bg-gray-100 transition"><HeartIcon size={20} /></button>
                            </div>

                            {/* Detay Sekmeleri */}
                            <div className="border-b border-gray-200">
                                <nav className="-mb-px flex space-x-6 overflow-x-auto no-scrollbar">
                                    {tabs.map(tab => (
                                        <button key={tab.id}
                                                onClick={() => setActiveTab(tab.id)}
                                                className={`whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm ${activeTab === tab.id ? 'border-gray-800 text-gray-900' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'}`}>
                                            {tab.label}
                                        </button>
                                    ))}
                                </nav>
                            </div>
                            
                            {/* Sekme İçerikleri (TÜM ALANLAR GÜNCELLENDİ) */}
                            <div className="py-6 text-gray-600 leading-relaxed text-sm prose">
                                {activeTab === 'description' && <p>{product.description}</p>}
                                {activeTab === 'story' && <p>{product.story || "Bu ürün için henüz bir hikaye eklenmemiş."}</p>}
                                {activeTab === 'details' && (
                                    <ul>
                                        <li><strong>Materyal:</strong> {product.material}</li>
                                        <li><strong>Boyutlar:</strong> {product.dimensions}</li>
                                        <li><strong>Ağırlık:</strong> {product.weight} kg</li>
                                    </ul>
                                )}
                                {activeTab === 'shipping' && <p>{product.shippingInfo || "Standart kargo bilgileri geçerlidir."}</p>}
                            </div>
                        </div>
                    </div>
                </div>
            );
        };
        
        // The Main App Component
        const App = () => {
            const [currentPath, setCurrentPath] = React.useState(window.location.pathname);
            const [isLoggedIn, setIsLoggedIn] = React.useState(false);
            const [userType, setUserType] = React.useState(null);
            const [language, setLanguage] = React.useState('Türkçe');
            const [currency, setCurrency] = React.useState('TRY');
            const [currentUser, setCurrentUser] = React.useState(null);
            const [isSearchOpen, setIsSearchOpen] = React.useState(false);
            const [isMobileMenuOpen, setIsMobileMenuOpen] = React.useState(false);
            
            const navigate = (path) => {
                window.history.pushState({}, '', path);
                setCurrentPath(path);
            };

            const handleUserIconClick = () => {
                if (isLoggedIn) {
                    if (userType === 'user') navigate('/user-dashboard');
                    else if (userType === 'seller') window.location.href = 'seller-dashboard.html';
                    else if (userType === 'admin') window.location.href = 'admin-dashboard.html';
                } else {
                    navigate('/login');
                }
            };

            React.useEffect(() => {
                const unsubscribe = window.onAuthStateChanged(window.firebaseAuth, async (user) => {
                    if (user) {
                        const userDocRef = window.doc(window.firebaseFirestore, 'users', user.uid);
                        const userDocSnap = await window.getDoc(userDocRef);
                        const role = userDocSnap.exists() ? userDocSnap.data().role : 'user';
                        setCurrentUser(user);
                        setIsLoggedIn(true);
                        setUserType(role);

                        if (role === 'seller' && !window.location.pathname.includes('seller-dashboard.html')) {
                             if(currentPath === '/login') window.location.href = 'seller-dashboard.html';
                        } else if (role === 'admin' && !window.location.pathname.includes('admin-dashboard.html')) {
                            if(currentPath === '/login') window.location.href = 'admin-dashboard.html';
                        }
                    } else {
                        setCurrentUser(null);
                        setIsLoggedIn(false);
                        setUserType(null);
                        if (window.location.pathname.includes('-dashboard')) {
                           window.location.href = '/'; 
                        }
                    }
                });
                const handlePopState = () => setCurrentPath(window.location.pathname);
                window.addEventListener('popstate', handlePopState);
                return () => {
                    unsubscribe();
                    window.removeEventListener('popstate', handlePopState);
                };
            }, [currentPath]);
            
            const t = (key) => translations[language]?.[key] || key;
            
        const renderMainContent = () => {
            const path = currentPath; 
        
            if (path.toLowerCase().startsWith('/products/')) {
                const pathParts = path.split('/');
                const productId = pathParts[2];
                if (productId) {
                    return <ProductPage productId={productId} setCurrentPath={navigate} t={t} currency={currency} />;
                }
            }

            const lowerCasePath = path.toLowerCase();
            if (lowerCasePath.includes('login')) return <LoginPage setCurrentPath={navigate} t={t} />;
            if (lowerCasePath.includes('register')) return <UserRegisterPage setCurrentPath={navigate} t={t} />;
            if (lowerCasePath.includes('seller-register')) return <SellerRegisterPage setCurrentPath={navigate} t={t} />;
            
            if (isLoggedIn && userType === 'user' && lowerCasePath.includes('user-dashboard')) {
                return <UserDashboard setCurrentPath={navigate} t={t} currentUser={currentUser} currency={currency} />;
            }
            
            return <HomePage setCurrentPath={navigate} t={t} />;
        };

            return (
                <div className="min-h-screen bg-neutral-50 font-['Helvetica'] text-gray-800">
                    <ScrollingBanner t={t} />
                    <Navbar 
                        t={t} 
                        setCurrentPath={navigate} 
                        handleUserIconClick={handleUserIconClick}
                        isSearchOpen={isSearchOpen} 
                        setIsSearchOpen={setIsSearchOpen}
                        language={language}
                        setLanguage={setLanguage}
                        currency={currency}
                        setCurrency={setCurrency}
                        setIsMobileMenuOpen={setIsMobileMenuOpen}
                    />
                    {isMobileMenuOpen && <MobileMenu t={t} setCurrentPath={navigate} setIsMobileMenuOpen={setIsMobileMenuOpen} language={language} setLanguage={setLanguage} currency={currency} setCurrency={setCurrency} />}
                    {isSearchOpen && <SearchPanel t={t} setIsSearchOpen={setIsSearchOpen} setCurrentPath={navigate} />}
                    <main className={`container mx-auto px-4 md:p-10 ${isSearchOpen || isMobileMenuOpen ? 'hidden' : ''}`}>
                        {renderMainContent()}
                    </main>
                    {!isMobileMenuOpen && <MobileBottomBar t={t} handleUserIconClick={handleUserIconClick} />}
                    {!currentPath.includes('dashboard') && !currentPath.includes('products') && <Footer t={t} />}
                </div>
            );
        };
        
        // Final Render Call
        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>

<!-- Injected: Cart & Favorites & Category Listing logic -->
<script type="text/babel">
/** UTIL **/

// Create a small flying dot animation from srcEl to target (CSS selector)
const flyTo = (srcEl, targetSelector, isFav=false) => {
  try {
    const tgt = document.querySelector(targetSelector);
    if (!srcEl || !tgt) return;
    const a = srcEl.getBoundingClientRect();
    const b = tgt.getBoundingClientRect();
    const dot = document.createElement('div');
    dot.className = 'fly-dot' + (isFav ? ' fav' : '');
    dot.style.transform = `translate(${a.left + a.width/2}px, ${a.top + a.height/2}px)`;
    document.body.appendChild(dot);
    requestAnimationFrame(()=>{
      dot.style.transform = `translate(${b.left + b.width/2}px, ${b.top + b.height/2}px)`;
    });
    setTimeout(()=>{ dot.remove(); }, 700);
  } catch(e){}
};

const getActiveUid = () => {
  const user = window.firebaseAuth?.currentUser;
  return user?.uid || null;
};

/** SERVICES **/
const CartService = {
  async getDocRef() {
    let uid = getActiveUid();
    if (!uid && window.firebaseAuth) {
      try { await window.signInAnonymously(window.firebaseAuth); uid = getActiveUid(); } catch(e){}
    }
    if (!uid) throw new Error('No auth uid');
    return window.doc(window.firebaseFirestore, 'carts', uid);
  },
  async get() {
    try {
      const ref = await this.getDocRef();
      const snap = await window.getDoc(ref);
      return snap.exists() ? (snap.data().items || []) : [];
    } catch(e){ console.error('get cart error', e); return []; }
  },
  async add(item) {
    const ref = await this.getDocRef();
    const base = { productId: item.productId, qty: item.qty || 1, price: item.price || 0, title: item.title || '', image: item.image || '' };
    try {
      const snap = await window.getDoc(ref);
      if (!snap.exists()) {
        await window.setDoc(ref, { items: [base], updatedAt: Date.now() });
      } else {
        const items = snap.data().items || [];
        const idx = items.findIndex(i => i.productId === base.productId);
        if (idx >= 0) { items[idx].qty += base.qty; } else { items.push(base); }
        await window.updateDoc(ref, { items, updatedAt: Date.now() });
      }
    } catch(e){
      console.error('add to cart error', e);
      // fallback create
      await window.setDoc(ref, { items: [base], updatedAt: Date.now() }, { merge: true });
    }
  },
  async remove(productId) {
    const ref = await this.getDocRef();
    try {
      const snap = await window.getDoc(ref);
      if (!snap.exists()) return;
      const items = (snap.data().items || []).filter(i => i.productId !== productId);
      await window.updateDoc(ref, { items, updatedAt: Date.now() });
    } catch(e){ console.error('remove from cart error', e); }
  },
  async clear() {
    const ref = await this.getDocRef();
    try { await window.updateDoc(ref, { items: [], updatedAt: Date.now() }); } catch(e){ await window.setDoc(ref, { items: [], updatedAt: Date.now() }); }
  }
};

const FavoriteService = {
  async getDocRef() {
    let uid = getActiveUid();
    if (!uid && window.firebaseAuth) {
      try { await window.signInAnonymously(window.firebaseAuth); uid = getActiveUid(); } catch(e){}
    }
    if (!uid) throw new Error('No auth uid');
    return window.doc(window.firebaseFirestore, 'favorites', uid);
  },
  async get() {
    const ref = await this.getDocRef();
    const snap = await window.getDoc(ref);
    return snap.exists() ? (snap.data().items || []) : [];
  },
  async toggle(item) {
    const ref = await this.getDocRef();
    const snap = await window.getDoc(ref);
    let items = [];
    if (!snap.exists()) {
      items = [item];
      await window.setDoc(ref, { items, updatedAt: Date.now() });
      return true;
    } else {
      items = snap.data().items || [];
      const exists = items.find(i => i.productId === item.productId);
      if (exists) {
        items = items.filter(i => i.productId !== item.productId);
        await window.updateDoc(ref, { items, updatedAt: Date.now() });
        return false;
      } else {
        items.push(item);
        await window.updateDoc(ref, { items, updatedAt: Date.now() });
        return true;
      }
    }
  }
};

/** AUTH MIGRATION (anon -> user) **/
if (window.firebaseAuth) {
  window.onAuthStateChanged(window.firebaseAuth, async (user) => {
    try {
      if (user) {
        const anonUid = localStorage.getItem('anonUid');
        if (!anonUid || anonUid === user.uid) return;
        // merge favorites
        const favAnonRef = window.doc(window.firebaseFirestore, 'favorites', anonUid);
        const favUserRef = window.doc(window.firebaseFirestore, 'favorites', user.uid);
        const favAnonSnap = await window.getDoc(favAnonRef);
        const favUserSnap = await window.getDoc(favUserRef);
        const a = favAnonSnap.exists() ? (favAnonSnap.data().items || []) : [];
        const b = favUserSnap.exists() ? (favUserSnap.data().items || []) : [];
        const merged = [...b];
        a.forEach(x => { if (!merged.find(y => y.productId === x.productId)) merged.push(x); });
        if (merged.length) await window.setDoc(favUserRef, { items: merged, updatedAt: Date.now() }, { merge: true });
        try { await window.setDoc(favAnonRef, { items: [] }, { merge: true }); } catch(e){}
        // merge cart
        const cartAnonRef = window.doc(window.firebaseFirestore, 'carts', anonUid);
        const cartUserRef = window.doc(window.firebaseFirestore, 'carts', user.uid);
        const cartAnonSnap = await window.getDoc(cartAnonRef);
        const cartUserSnap = await window.getDoc(cartUserRef);
        const ca = cartAnonSnap.exists() ? (cartAnonSnap.data().items || []) : [];
        const cb = cartUserSnap.exists() ? (cartUserSnap.data().items || []) : [];
        const cmerged = [...cb];
        ca.forEach(x => {
          const i = cmerged.findIndex(y => y.productId === x.productId);
          if (i>=0) cmerged[i].qty += x.qty||1; else cmerged.push(x);
        });
        if (cmerged.length) await window.setDoc(cartUserRef, { items: cmerged, updatedAt: Date.now() }, { merge: true });
        try { await window.setDoc(cartAnonRef, { items: [] }, { merge: true }); } catch(e){}
      }
    } catch(err){ console.error('auth migration error', err); }
  });
}


/** OVERLAYS **/
const OverlayRoot = (() => {
  const hostId = 'kadraj-overlays-host';
  let root = document.getElementById(hostId);
  if (!root) {
    root = document.createElement('div');
    root.id = hostId;
    document.body.appendChild(root);
  }
  const reactRoot = ReactDOM.createRoot(root);
  return { render: (node) => reactRoot.render(node) };
})();

const Modal = ({ title, onClose, children }) => (
  <div className="fixed inset-0 z-[1000] flex items-center justify-center">
    <div className="absolute inset-0 bg-black/40" onClick={onClose}></div>
    <div className="relative bg-white w-[92%] md:w-[800px] max-h-[80vh] overflow-auto rounded-2xl shadow-xl p-4 md:p-6">
      <div className="flex items-center justify-between mb-4">
        <h3 className="text-lg font-semibold">{title}</h3>
        <button onClick={onClose} className="p-2 hover:bg-gray-100 rounded-full">
          <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="none" stroke="currentColor" strokeWidth="2"><path d="M18 6L6 18M6 6l12 12"/></svg>
        </button>
      </div>
      {children}
    </div>
  </div>
);

const CartOverlay = ({ onClose }) => {
  const [items, setItems] = React.useState([]);
  React.useEffect(() => { CartService.get().then(setItems); }, []);
  const total = items.reduce((s, it) => s + (it.price||0) * (it.qty||1), 0);
  return (
    <Modal title="Sepetim" onClose={onClose}>
      <div className="space-y-3">
        {items.length === 0 && <p className="text-sm text-gray-500">Sepetiniz boş.</p>}
        {items.map(it => (
          <div key={it.productId} className="flex items-center gap-3 border rounded-lg p-2">
            <img src={it.image || 'https://via.placeholder.com/80'} className="w-16 h-16 object-cover rounded" />
            <div className="flex-1">
              <p className="font-medium">{it.title || it.productId}</p>
              <p className="text-sm text-gray-500">Adet: {it.qty} • Fiyat: {it.price}</p>
            </div>
            <button onClick={async ()=>{ await CartService.remove(it.productId); setItems(await CartService.get()); }} className="text-sm px-3 py-1 border rounded hover:bg-gray-50">Kaldır</button>
          </div>
        ))}
      </div>
      <div className="mt-4 flex items-center justify-between">
        <span className="font-semibold">Toplam: {total.toFixed(2)}</span>
        <div className="flex gap-2">
          <button onClick={async()=>{ await CartService.clear(); setItems([]); }} className="px-3 py-2 border rounded hover:bg-gray-50">Temizle</button>
          <button className="px-4 py-2 bg-black text-white rounded">Ödeme Adımına Geç</button>
        </div>
      </div>
    </Modal>
  );
};

const FavoritesOverlay = ({ onClose }) => {
  const [items, setItems] = React.useState([]);
  React.useEffect(() => { FavoriteService.get().then(setItems); }, []);
  return (
    <Modal title="Favorilerim" onClose={onClose}>
      <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
        {items.length === 0 && <p className="text-sm text-gray-500">Henüz favori eklenmedi.</p>}
        {items.map(it => (
          <div key={it.productId} className="flex items-center gap-3 border rounded-lg p-2">
            <img src={it.image || 'https://via.placeholder.com/80'} className="w-16 h-16 object-cover rounded" />
            <div className="flex-1">
              <p className="font-medium">{it.title || it.productId}</p>
              <p className="text-sm text-gray-500">{it.price ? (it.price + ' ₺') : ''}</p>
            </div>
            <button onClick={async ()=>{ await FavoriteService.toggle({productId: it.productId}); setItems(await FavoriteService.get()); }} className="text-sm px-3 py-1 border rounded hover:bg-gray-50">Kaldır</button>
          </div>
        ))}
      </div>
    </Modal>
  );
};

const CategoryOverlay = ({ slug, onClose }) => {
  const [items, setItems] = React.useState([]);
  React.useEffect(() => {
    (async ()=>{
      try {
        const productsRef = window.collection(window.firebaseFirestore, 'products');
        const qs = await window.getDocs(productsRef);
        const all = qs.docs.map(d => ({ id: d.id, ...d.data() }));
        const lower = slug.toLowerCase();
        const filtered = all.filter(p => (p.category||'').toLowerCase().includes(lower));
        setItems(filtered);
      } catch(e){ console.error(e); }
    })();
  }, [slug]);
  return (
    <Modal title={"Kategori: " + slug} onClose={onClose}>
      <div className="grid grid-cols-2 md:grid-cols-3 gap-4">
        {items.map(p => (
          <div key={p.id} className="border rounded-lg overflow-hidden">
            <img src={(p.imageUrls && p.imageUrls[0]) || 'https://via.placeholder.com/400'} className="w-full h-40 object-cover"/>
            <div className="p-2">
              <p className="font-medium line-clamp-2">{p.productName || p.id}</p>
              <p className="text-sm text-gray-500">{p.price ? (p.price + ' ₺') : ''}</p>
              <div className="mt-2 flex gap-2">
                <button className="flex-1 px-2 py-1 border rounded text-sm hover:bg-gray-50" data-quick-add data-product-id={p.id}>Sepete Ekle</button>
                <button className="px-2 py-1 border rounded text-sm hover:bg-gray-50" data-quick-fav data-product-id={p.id}>❤</button>
              </div>
            </div>
          </div>
        ))}
      </div>
    </Modal>
  );
};

/** GLOBAL HELPERS **/
window.openCart = () => OverlayRoot.render(<CartOverlay onClose={()=>OverlayRoot.render(null)} />);
window.openFavorites = () => OverlayRoot.render(<FavoritesOverlay onClose={()=>OverlayRoot.render(null)} />);
window.openCategory = (slug) => navigateTo(`/category/${slug}`);


/** ROUTER: Category full page (not overlay) **/
const RouterRoot = (() => {
  const id = 'kadraj-router-root';
  let el = document.getElementById(id);
  if (!el) {
    el = document.createElement('div');
    el.id = id;
    el.style.position = 'fixed';
    el.style.inset = '0';
    el.style.zIndex = '999'; /* below overlays (1000), above app */
    el.style.display = 'none';
    document.body.appendChild(el);
  }
  const root = ReactDOM.createRoot(el);
  return {
    show(node) { el.style.display = 'block'; root.render(node); window.scrollTo(0,0); },
    hide() { el.style.display = 'none'; root.render(null); }
  };
})();

const CategoryPage = ({ slug }) => {
  const [items, setItems] = React.useState([]);
  React.useEffect(() => {
    (async ()=>{
      try{
        const productsRef = window.collection(window.firebaseFirestore, 'products');
        const qs = await window.getDocs(productsRef);
        const all = qs.docs.map(d => ({ id: d.id, ...d.data() }));
        const s = (slug||'').toLowerCase();
        const filtered = all.filter(p => (p.category||'').toLowerCase().includes(s));
        setItems(filtered);
      }catch(e){ console.error(e); }
    })();
  }, [slug]);
  return (
    <div className="bg-white w-full h-full overflow-y-auto">
      <div className="max-w-6xl mx-auto p-4 md:p-6">
        <div className="flex items-center justify-between mb-4">
          <h1 className="text-xl md:text-2xl font-bold capitalize">{slug}</h1>
          <button onClick={()=>{ history.back(); }} className="px-3 py-2 border rounded hover:bg-gray-50">Geri</button>
        </div>
        {items.length === 0 ? (
          <p className="text-sm text-gray-500">Bu kategoride ürün bulunamadı.</p>
        ) : (
          <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
            {items.map(p => (
              <div key={p.id} className="border rounded-lg overflow-hidden">
                <img src={(p.imageUrls && p.imageUrls[0]) || 'https://via.placeholder.com/400'} className="w-full h-40 object-cover"/>
                <div className="p-2">
                  <p className="font-medium line-clamp-2">{p.productName || p.id}</p>
                  <p className="text-sm text-gray-500">{p.price ? (p.price + ' ₺') : ''}</p>
                  <div className="mt-2 flex gap-2">
                    <button className="flex-1 px-2 py-1 border rounded text-sm hover:bg-gray-50" data-quick-add data-product-id={p.id}>Sepete Ekle</button>
                    <button className="px-2 py-1 border rounded text-sm hover:bg-gray-50" data-quick-fav data-product-id={p.id}>❤</button>
                  </div>
                </div>
              </div>
            ))}
          </div>
        )}
      </div>
    </div>
  );
};

const navigateTo = (path) => {
  if (window.location.pathname !== path) history.pushState({}, '', path);
  handleRoute();
};

const handleRoute = () => {
  const path = window.location.pathname;
  if (path.startsWith('/category/')) {
    const slug = decodeURIComponent(path.split('/category/')[1] || '');
    RouterRoot.show(<CategoryPage slug={slug} />);
  } else {
    RouterRoot.hide();
  }
};

window.addEventListener('popstate', handleRoute);
window.addEventListener('load', handleRoute);

/** EVENT DELEGATION **/
const getProductIdFromUrl = () => {
  try {
    const path = window.location.pathname.toLowerCase();
    const parts = path.split('/').filter(Boolean);
    const idx = Math.max(parts.indexOf('product'), parts.indexOf('products'));
    if (idx >= 0 && parts[idx+1]) return parts[idx+1];
    // also try ?id=
    const url = new URL(window.location.href);
    const idParam = url.searchParams.get('id');
    if (idParam) return idParam;
  } catch(e){}
  return null;
};

const innerTextTrim = (el) => (el && (el.textContent||'').trim()) || '';
const parsePrice = (s) => {
  if (!s) return null;
  const m = (s.replace(/\./g,'').match(/(\d+[\d\s]*)/)||[])[1];
  if (!m) return null;
  return parseInt(m.replace(/\s/g,''),10);
};

const resolveProductFromPage = async () => {
  // Try URL-based first
  let pid = getProductIdFromUrl();
  if (pid) return pid;
  try {
    // Try to read product name and price from DOM
    const name = innerTextTrim(document.querySelector('h1, .product-title, [data-product-name]'));
    const priceText = innerTextTrim(document.querySelector('[class*="price"], [data-price]'));
    const priceVal = parsePrice(priceText);
    const productsRef = window.collection(window.firebaseFirestore, 'products');
    const qs = await window.getDocs(productsRef);
    const all = qs.docs.map(d => ({ id: d.id, ...d.data() }));

    // Prefer exact name match (case-insensitive)
    if (name) {
      const byName = all.find(p => (p.productName||'').toLowerCase() === name.toLowerCase());
      if (byName) return byName.id;
      // try includes
      const byInc = all.find(p => (p.productName||'').toLowerCase().includes(name.toLowerCase()));
      if (byInc) return byInc.id;
    }
    // Try price-only (if unique)
    if (priceVal != null) {
      const byPrice = all.filter(p => (p.price|0) === priceVal);
      if (byPrice.length === 1) return byPrice[0].id;
    }
  } catch(e){ console.warn('resolveProductFromPage failed', e); }
  return null;
};


document.addEventListener('click', async (e) => {
  const el = e.target.closest('[data-add-to-cart],[data-toggle-favorite],[data-open-cart],[data-open-favorites],[data-category],[data-quick-add],[data-quick-fav],a[href^="/category/"]');
  if (!el) return;

  // Openers
  if (el.hasAttribute('data-open-cart')) { e.preventDefault(); window.openCart(); return; }
  if (el.hasAttribute('data-open-favorites')) { e.preventDefault(); window.openFavorites(); return; }

  // Category open
  if (el.matches && el.matches('a[href^="/category/"]')) {
    e.preventDefault();
    const href = el.getAttribute('href');
    const slug = href.split('/category/')[1] || '';
    if (slug) { navigateTo(`/category/${slug}`); }
    return;
  }

  if (el.hasAttribute('data-category')) {
    e.preventDefault();
    const slug = el.getAttribute('data-category');
    navigateTo(`/category/${slug}`);
    return;
  }

  // Quick actions from category grid
  if (el.hasAttribute('data-quick-add') || el.hasAttribute('data-quick-fav')) {
    e.preventDefault();
    const productId = el.getAttribute('data-product-id');
    // fetch product
    try {
      const ref = window.doc(window.firebaseFirestore, 'products', productId);
      const snap = await window.getDoc(ref);
      const data = snap.exists() ? snap.data() : {};
      const payload = { productId, qty: 1, price: data.price || 0, title: data.productName || '', image: (data.imageUrls && data.imageUrls[0]) || '' };
      if (el.hasAttribute('data-quick-add')) { await CartService.add(payload); window.dispatchEvent(new CustomEvent('cart:changed')); el.classList.add('btn-added','btn-ring'); setTimeout(()=>{ el.classList.remove('btn-added','btn-ring'); }, 650); flyTo(el, '[data-open-cart]'); }
      if (el.hasAttribute('data-quick-fav')) { await FavoriteService.toggle({ productId, title: payload.title, price: payload.price, image: payload.image }); window.dispatchEvent(new CustomEvent('favorites:changed')); el.classList.add('btn-added'); setTimeout(()=>{ el.classList.remove('btn-added'); }, 550); flyTo(el, '[data-open-favorites]', true); }
    } catch(err){ console.error(err); }
    return;
  }

  // Product detail buttons
  if (el.hasAttribute('data-add-to-cart') || el.hasAttribute('data-toggle-favorite')) {
    e.preventDefault();
    // try to get productId from nearest container
    const container = el.closest('[data-product-id]');
    let productId = container ? container.getAttribute('data-product-id') : null;
    if (!productId) { productId = await resolveProductFromPage(); }
    if (!productId) { console.warn('productId not found in DOM'); return; }
    try {
      const ref = window.doc(window.firebaseFirestore, 'products', productId);
      const snap = await window.getDoc(ref);
      const data = snap.exists() ? snap.data() : {};
      const payload = { productId, qty: 1, price: data.price || 0, title: data.productName || '', image: (data.imageUrls && data.imageUrls[0]) || '' };
      if (el.hasAttribute('data-add-to-cart')) await CartService.add(payload);
      if (el.hasAttribute('data-toggle-favorite')) { const added = await FavoriteService.toggle({ productId, title: payload.title, price: payload.price, image: payload.image }); window.dispatchEvent(new CustomEvent('favorites:changed')); el.classList.add('btn-added'); setTimeout(()=>{ el.classList.remove('btn-added'); }, 550); flyTo(el, '[data-open-favorites]', true); }
    } catch(err){ console.error(err); }
    return;
  }
});

/** NAVBAR / BOTTOM BAR HOOKS **/
const tryAttachBarButtons = () => {
  // Also match by aria-label on links or buttons
  document.querySelectorAll('a[aria-label],button[aria-label]').forEach(el => {
    const t = (el.getAttribute('aria-label')||'').trim().toLowerCase();
    if (t === 'sepet' || t === 'sepetim' || t === 'cart' || t === 'my cart') el.setAttribute('data-open-cart','true');
    if (t === 'favoriler' || t === 'favorites') el.setAttribute('data-open-favorites','true');
  });
  // If there are plain icon-only anchors with ShoppingBag/Heart, add data-open-*
  document.querySelectorAll('a,button').forEach(el => {
    const title = (el.getAttribute('title')||'').toLowerCase();
    if (title.includes('sepet') || title.includes('cart')) el.setAttribute('data-open-cart','true');
    if (title.includes('favori') || title.includes('favorite')) el.setAttribute('data-open-favorites','true');
  });

  // Auto-tag product detail buttons if data-* not present (enhanced)
  document.querySelectorAll('button').forEach(btn => {
    const t = (btn.textContent || '').trim().toLowerCase();
    if (!btn.hasAttribute('data-add-to-cart') && (t === 'sepete ekle' || t === 'add to cart')) {
      btn.setAttribute('data-add-to-cart','true');
    }
    // heart-only button heuristic: contains an SVG with stroke set and no text
    if (!btn.hasAttribute('data-toggle-favorite')) {
      const hasHeart = btn.querySelector('svg') && (btn.innerText.trim() === '' || btn.innerText.trim() === '❤');
      if (hasHeart) btn.setAttribute('data-toggle-favorite','true');
    }
  });

  // Add data-open attributes to ShoppingBag and Heart icons in bottom bar if exist
  document.querySelectorAll('span').forEach(sp => {
    const t = sp.textContent.trim().toLowerCase();
    if (t === 'sepet' || t === 'sepetim' || t === 'my cart') {
      const a = sp.closest('a'); if (a) a.setAttribute('data-open-cart','true');
    }
    const f = sp.textContent.trim().toLowerCase();
    if (f === 'favoriler' || f === 'favorites') {
      const a = sp.closest('a'); if (a) a.setAttribute('data-open-favorites','true');
    }
  });

  // Header menu items: intercept /category/<slug>
  document.querySelectorAll('nav a[href^="/category/"], a[data-category]').forEach(a => {
    const href = a.getAttribute('href');
    const slug = href.split('/category/')[1];
    if (slug) a.setAttribute('data-category', slug);
  });
};
const mo = new MutationObserver(() => tryAttachBarButtons());
mo.observe(document.documentElement, { childList: true, subtree: true });
window.addEventListener('load', tryAttachBarButtons);
</script>


<script type="text/babel">
// ------- Helpers (safe, non-breaking) -------
const getUid = () => window.firebaseAuth?.currentUser?.uid || null;

// Use existing services if present; otherwise minimal inline implementations
const CartService = window.CartService || {
  async get() {
    try{
      const uid = getUid(); if(!uid) return [];
      const ref = window.doc(window.firebaseFirestore, 'carts', uid);
      const snap = await window.getDoc(ref);
      return snap.exists() ? (snap.data().items || []) : [];
    }catch(e){ console.warn('cart get err', e); return []; }
  },
  async add(item){
    try{
      const uid = getUid(); if(!uid) return;
      const ref = window.doc(window.firebaseFirestore, 'carts', uid);
      const snap = await window.getDoc(ref);
      let items = snap.exists() ? (snap.data().items||[]) : [];
      const i = items.findIndex(x => x.productId === item.productId);
      if(i>=0){ items[i].qty = (items[i].qty||1) + (item.qty||1); }
      else { items.push({ productId:item.productId, qty:item.qty||1, price:item.price||0, title:item.title||'', image:item.image||'' }); }
      if(snap.exists()) await window.updateDoc(ref, { items, updatedAt: Date.now() });
      else await window.setDoc(ref, { items, updatedAt: Date.now() });
    }catch(e){ console.warn('cart add err', e); }
  }
};

const FavoriteService = window.FavoriteService || {
  async get() {
    try{
      const uid = getUid(); if(!uid) return [];
      const ref = window.doc(window.firebaseFirestore, 'favorites', uid);
      const snap = await window.getDoc(ref);
      return snap.exists() ? (snap.data().items || []) : [];
    }catch(e){ console.warn('fav get err', e); return []; }
  },
  async toggle(item){
    try{
      const uid = getUid(); if(!uid) return false;
      const ref = window.doc(window.firebaseFirestore, 'favorites', uid);
      const snap = await window.getDoc(ref);
      let items = snap.exists() ? (snap.data().items||[]) : [];
      const idx = items.findIndex(x => x.productId === item.productId);
      if(idx>=0){ items.splice(idx,1); }
      else { items.push(item); }
      if(snap.exists()) await window.updateDoc(ref, { items, updatedAt: Date.now() });
      else await window.setDoc(ref, { items, updatedAt: Date.now() });
      return idx<0;
    }catch(e){ console.warn('fav toggle err', e); return false; }
  }
};

// Ensure anonymous auth so rules allow writes
(async()=>{ try{ if(window.firebaseAuth && !window.firebaseAuth.currentUser){ await window.signInAnonymously(window.firebaseAuth); } }catch(e){} })();

// ------- Icon wiring (desktop + mobile) -------
const ensureIconBadges = () => {
  document.querySelectorAll('[data-open-cart],[data-open-favorites]').forEach(el => {
    el.classList.add('k-icon-wrap');
    if(!el.querySelector('.k-badge')){
      const b = document.createElement('span'); b.className='k-badge'; el.appendChild(b);
    }
  });
};

const syncFavIndicator = async () => {
  const favs = await FavoriteService.get();
  const has = favs.length > 0;
  document.querySelectorAll('[data-open-favorites]').forEach(el => el.classList.toggle('fav-indicator-on', has));
};

const syncCartBadges = async () => {
  ensureIconBadges();
  const items = await CartService.get();
  const count = items.reduce((s,i)=>s+(i.qty||1),0);
  document.querySelectorAll('[data-open-cart] .k-badge').forEach(b=>{
    b.textContent = count;
    b.style.display = count>0 ? 'inline-block' : 'none';
  });
};

// ------- Resolve product from page (detail & list) -------
const getProductIdFromUrl = () => {
  try {
    const parts = location.pathname.toLowerCase().split('/').filter(Boolean);
    const i = Math.max(parts.indexOf('product'), parts.indexOf('products'));
    if (i >= 0 && parts[i+1]) return parts[i+1];
    const u = new URL(location.href);
    return u.searchParams.get('id');
  } catch(e){ return null; }
};

const resolveProductFromPage = async () => {
  let pid = document.querySelector('[data-product-id]')?.getAttribute('data-product-id');
  if(!pid) pid = getProductIdFromUrl();
  if(pid) return pid;

  // Fallback: by title + price
  try{
    const title = (document.querySelector('h1')?.textContent||'').trim().toLowerCase();
    const priceText = (document.querySelector('[class*="price"],[data-price]')?.textContent||'').replace(/\./g,'');
    const ref = window.collection(window.firebaseFirestore,'products');
    const qs = await window.getDocs(ref);
    const all = qs.docs.map(d=>({id:d.id,...d.data()}));
    if(title){
      const ex = all.find(p => (p.productName||'').toLowerCase()===title); if(ex) return ex.id;
      const inc = all.find(p => (p.productName||'').toLowerCase().includes(title)); if(inc) return inc.id;
    }
    const m = (priceText||'').match(/(\d[\d\s]*)/);
    if(m){
      const val = parseInt(m[1].replace(/\s/g,''),10);
      const by = all.filter(p => (p.price|0)===val);
      if(by.length===1) return by[0].id;
    }
  }catch(e){}
  return null;
};

// ------- Product page: show "Sepette (adet)" on button -------
const updateProductDetailButton = async () => {
  const btn = document.querySelector('[data-add-to-cart]') || Array.from(document.querySelectorAll('button')).find(b => (b.textContent||'').toLowerCase().includes('sepete ekle'));
  if(!btn) return;
  const pid = await resolveProductFromPage(); if(!pid) return;
  const items = await CartService.get();
  const it = items.find(x => x.productId === pid);
  // add inline subtext
  btn.querySelectorAll('.k-inlist').forEach(n=>n.remove());
  if(it){
    const span = document.createElement('span'); span.className='k-inlist'; span.textContent = `Sepette (${it.qty||1})`;
    btn.appendChild(span);
  }
};

// ------- Products list/grid: show "Sepette (adet)" -------
const updateListBadges = async () => {
  const items = await CartService.get();
  const map = new Map(items.map(i => [i.productId, i.qty||1]));
  // cards linking to /products/<id>
  document.querySelectorAll('a[href*="/products/"]').forEach(a => {
    const m = a.getAttribute('href').match(/\/products\/([^\/?#]+)/);
    if(!m) return;
    const pid = m[1];
    const qty = map.get(pid);
    if(!qty) return;
    const host = a.closest('[data-card]') || a;
    if(!host.querySelector('.k-inlist')){
      const p = document.createElement('div');
      p.className = 'k-inlist';
      p.textContent = `Sepette (${qty})`;
      host.appendChild(p);
    } else {
      host.querySelector('.k-inlist').textContent = `Sepette (${qty})`;
    }
  });
};

// ------- Global click delegation (desktop+mobile icons, add-to-cart, favorite) -------
document.addEventListener('click', async (e) => {
  const el = e.target.closest('[data-open-cart],[data-open-favorites],[data-add-to-cart],[data-toggle-favorite]');
  if(!el) return;

  if (el.hasAttribute('data-open-cart')) { e.preventDefault(); if (window.openCart) window.openCart(); return; }
  if (el.hasAttribute('data-open-favorites')) { e.preventDefault(); if (window.openFavorites) window.openFavorites(); return; }

  // Product actions
  if (el.hasAttribute('data-add-to-cart') || el.hasAttribute('data-toggle-favorite')) {
    e.preventDefault();
    // resolve product
    const pid = await resolveProductFromPage();
    if(!pid) return;

    // fetch minimal product info
    let payload = { productId: pid, qty: 1, price: 0, title: '', image: '' };
    try {
      const ref = window.doc(window.firebaseFirestore, 'products', pid);
      const snap = await window.getDoc(ref);
      const d = snap.exists() ? snap.data() : {};
      payload = { productId: pid, qty: 1, price: d.price||0, title: d.productName||'', image: (d.imageUrls && d.imageUrls[0]) || '' };
    } catch(e){}

    if (el.hasAttribute('data-add-to-cart')) {
      await CartService.add(payload);
      window.dispatchEvent(new CustomEvent('cart:changed'));
    }
    if (el.hasAttribute('data-toggle-favorite')) {
      await FavoriteService.toggle({ productId: pid, title: payload.title, price: payload.price, image: payload.image });
      window.dispatchEvent(new CustomEvent('favorites:changed'));
    }
  }
});

// ------- Boot & react to changes -------
const refreshAll = () => { syncCartBadges(); syncFavIndicator(); updateProductDetailButton(); updateListBadges(); };
window.addEventListener('load', () => { ensureIconBadges(); refreshAll(); });
window.addEventListener('cart:changed', refreshAll);
window.addEventListener('favorites:changed', refreshAll);
const mo = new MutationObserver(()=>{ ensureIconBadges(); });
mo.observe(document.documentElement,{childList:true,subtree:true});
</script>


<script type="text/babel">
async function syncFavIndicator(){
  try{
    const uid = window.firebaseAuth?.currentUser?.uid || null;
    const btn = document.querySelector('[data-toggle-favorite]');
    if(!btn) return;
    if(!uid){ btn.classList.remove('fav-indicator-on'); return; }
    const pidEl = document.querySelector('[data-product-id]');
    let pid = pidEl ? pidEl.getAttribute('data-product-id') : null;
    if(!pid && typeof resolveProductFromPage==='function'){ pid = await resolveProductFromPage(); }
    if(!pid && typeof resolveProductFromPageX==='function'){ pid = await resolveProductFromPageX(); }
    if(!pid) return;
    const ref = window.doc(window.firebaseFirestore, 'favorites', uid);
    const snap = await window.getDoc(ref);
    const items = snap.exists() ? (snap.data().items||[]) : [];
    const on = items.some(i => i.productId === pid);
    btn.classList.toggle('fav-indicator-on', !!on);
  }catch(e){}
}
</script>


<!-- === Kadraj Enhancements Pack v14 (product-only changes) === -->
<style>
/* square media stage */
.k-stage { position: relative; width: 100%; aspect-ratio: 1 / 1; background:#f6f6f6; border-radius: 14px; overflow: hidden; }
.k-stage img, .k-stage video { position:absolute; inset:0; width:100%; height:100%; object-fit: contain; }
.k-thumbs { display:grid; grid-template-columns: repeat(8, minmax(0,1fr)); gap:.5rem; }
.k-thumbs button { border:1px solid #e5e7eb; border-radius:10px; overflow:hidden; background:#fff; }
.k-thumbs button.active { outline:2px solid #111; }
.k-thumbs img { width:100%; height:64px; object-fit:cover; }
.k-thumbs .vid { height:64px; background:#111; color:#fff; display:grid; place-items:center; font-size:10px; }

/* cart + badge */
.k-cart-badge,.k-cart-icon-badge{position:absolute;right:-6px;top:-8px;min-width:18px;height:18px;padding:0 5px;border-radius:9999px;font-size:11px;line-height:18px;text-align:center;background:#ef4444;color:#fff;font-weight:700;display:none}
.k-mobile-cart{position:relative;width:28px;height:28px;display:inline-block}
.k-mobile-cart svg{width:100%;height:100%;display:block}

/* wishlist visuals + animation */
.is-favorited svg{fill:currentColor !important;color:#ef4444}
@keyframes fav-pop { 0%{ transform:scale(.9);} 70%{ transform:scale(1.12);} 100%{ transform:scale(1);} }
.fav-anim { animation:fav-pop .25s ease; }

/* overlay cart drawer */
.k-cart-overlay{position:fixed;inset:0;background:rgba(0,0,0,.45);display:none;z-index:9999}
.k-cart-drawer{position:absolute;top:0;right:0;width:min(420px,100%);height:100%;background:#fff;box-shadow:-16px 0 40px rgba(0,0,0,.18);display:flex;flex-direction:column}

/* add-to-cart animated qty pill */
.k-qty { display:inline-flex; align-items:center; gap:.5rem; padding:.5rem .75rem; border:1px solid #111; border-radius:9999px; }
.k-qty button { width:26px; height:26px; border-radius:9999px; border:1px solid #111; line-height:24px; }
.k-qty .count { min-width:22px; text-align:center; font-weight:600; }
@keyframes btn-pulse { 0%{box-shadow:0 0 0 0 rgba(0,0,0,.2);} 100%{box-shadow:0 0 0 12px rgba(0,0,0,0);} }
.k-pulse { animation: btn-pulse .6s ease; }
</style>

<div id="k-cart-overlay" class="k-cart-overlay" aria-hidden="true">
  <div class="k-cart-drawer" role="dialog" aria-label="Sepet">
    <header class="p-4 border-b flex items-center justify-between">
      <div class="text-lg font-semibold">Sepet</div>
      <button id="k-cart-close" class="p-2" aria-label="Kapat">&times;</button>
    </header>
    <div id="k-cart-items" class="flex-1 overflow-auto p-4 space-y-3"></div>
    <div class="border-t p-4 space-y-3">
      <div>
        <label class="text-sm">Kupon Kodu</label>
        <input id="k-coupon" class="w-full mt-1 border rounded-lg p-2" placeholder="KUPON2025" />
      </div>
      <div class="flex items-center justify-between font-semibold">
        <span>Toplam</span><span id="k-total">0 ₺</span>
      </div>
      <div class="flex gap-2">
        <a href="#/cart" id="k-go-cart" class="flex-1 px-4 py-2 border rounded-lg text-center">Sepete Git</a>
        <a href="#/checkout" id="k-go-checkout" class="flex-1 px-4 py-2 bg-black text-white rounded-lg text-center">Ödeme Yap</a>
      </div>
    </div>
  </div>
</div>

<script type="text/babel">
// helpers
const $ = (s,r=document)=>r.querySelector(s);
const $$ = (s,r=document)=>Array.from(r.querySelectorAll(s));

// router
function navTo(rel){ const clean="#"+(rel.startsWith("/")?rel.slice(1):rel); if(location.hash!==clean) location.hash=clean; window.dispatchEvent(new HashChangeEvent("hashchange")); }
function hashPath(){ return location.hash.replace(/^#/, ""); }

// firebase aliases
const db = window.firebaseFirestore;
const doc = window.doc, getDoc = window.getDoc;
const collection = window.collection, getDocs = window.getDocs;

// data helpers
async function fetchAllProducts(){ try{ if(!db||!collection||!getDocs) return []; const qs = await getDocs(collection(db,"products")); return qs.docs.map(d=>({ id:d.id, ...(d.data?d.data():{}) })); }catch(_){ return []; } }
async function fetchProduct(id){ try{ if(!db||!doc||!getDoc) return null; const d = await getDoc(doc(db,"products",id)); return d.exists && d.exists() ? { id:d.id, ...(d.data?d.data():{}) } : null; }catch(_){ return null; } }
async function resolveProductId(){
  const host = document.querySelector("[data-product-id]"); if (host?.getAttribute("data-product-id")) return host.getAttribute("data-product-id");
  const m = location.pathname.match(/\/products?\/([^\/?#]+)/i); if (m) return decodeURIComponent(m[1]);
  return null; // ürün sayfası değilse denemeyelim
}
async function fetchUserByIdOrName(sellerId, sellerName){
  try{
    if (!db) return null;
    if (sellerId && doc && getDoc){
      const ds = await getDoc(doc(db,"users",sellerId));
      if (ds.exists && ds.exists()) return { id:ds.id, ...(ds.data?ds.data():{}) };
    }
    if (collection && getDocs){
      const qs = await getDocs(collection(db,"users"));
      for(const snap of qs.docs){
        const u = snap.data ? snap.data() : {};
        const name = (u.displayName||u.name||"").toLowerCase();
        if (sellerName && name && name === (sellerName||"").toLowerCase()) return { id:snap.id, ...u };
        if (u.sellerId===sellerId || u.uid===sellerId) return { id:snap.id, ...u };
      }
    }
  }catch(_){}
  return null;
}

// wishlist paint/sync (+ header heart)
function paintFavorite(on){
  const btn = document.querySelector("[data-toggle-favorite]"); if(btn){ btn.classList.toggle("is-favorited", !!on); btn.setAttribute("aria-pressed", on ? "true" : "false"); if(on){ btn.classList.add("fav-anim"); setTimeout(()=>btn.classList.remove("fav-anim"), 260);} }
  const headerHeart = document.querySelector('button[aria-label="Favoriler"], [data-open-favorites="true"]');
  if(headerHeart) headerHeart.classList.toggle("is-favorited", !!on);
}
async function syncFavoriteUI(){
  try{
    const pid = await resolveProductId(); // ürün sayfasında çalışsın
    const user = window.firebaseAuth?.currentUser || null;
    if(!user){ paintFavorite(false); return; }
    const w = await getDoc(doc(db,"wishlists",user.uid));
    const items = w.exists && w.exists() ? (w.data? w.data().items||[] : []) : [];
    const hasAny = items.length>0;
    const on = pid ? !!items.find(it => it?.productId===pid || it===pid) : hasAny;
    paintFavorite(on);
  }catch(_){}
}
document.addEventListener("click",(e)=>{
  const fav = e.target.closest("[data-toggle-favorite]");
  if(!fav) return;
  const user = window.firebaseAuth?.currentUser || null;
  if(!user || user.isAnonymous){ e.preventDefault(); navTo("/login"); return; }
  fav.classList.add("fav-anim"); fav.classList.toggle("is-favorited"); setTimeout(()=>fav.classList.remove("fav-anim"), 260);
  fav.setAttribute("aria-pressed", fav.classList.contains("is-favorited") ? "true" : "false");
}, true);
window.addEventListener("wishlist:changed", syncFavoriteUI);

// seller page
(function(){
  const main = document.querySelector("main") || document.getElementById("root") || document.body;
  const hostId = "k-route-host"; let host = document.getElementById(hostId);
  if (!host){ host = document.createElement("div"); host.id = hostId; main.appendChild(host); }
  const root = ReactDOM.createRoot(host); let showing=false;
  function mask(on){ Array.from(main.children).forEach(ch=>{ if(ch===host) return; if(on){ ch.setAttribute("data-k-hide","1"); ch.style.display="none"; } else if(ch.getAttribute("data-k-hide")==="1"){ ch.style.display=""; ch.removeAttribute("data-k-hide"); } }); }
  function SellerPage({ sellerId }){
    const [seller,setSeller] = React.useState(null); const [items,setItems]   = React.useState([]);
    React.useEffect(()=>{ (async()=>{ const s = await fetchUserByIdOrName(sellerId); setSeller(s); const all = await fetchAllProducts(); setItems(all.filter(p => (p.sellerId||p.seller||p.ownerId)===sellerId)); })(); }, [sellerId]);
    const avatar = seller?.photoURL || seller?.avatar || "https://via.placeholder.com/96";
    return (<div className="max-w-6xl mx-auto p-4 md:p-8">
      <div className="flex items-center gap-4 md:gap-6 mb-6"><img src={avatar} className="w-20 h-20 md:w-24 md:h-24 rounded-full object-cover border"/><div><h1 className="text-2xl md:text-3xl font-bold">{seller?.displayName||seller?.name||"Satıcı"}</h1>{seller?.location && <p className="text-gray-600">{seller.location}</p>}</div></div>
      {seller?.story && <section className="border rounded-2xl p-4 md:p-6 mb-8"><h2 className="text-xl font-semibold mb-2">Satıcının Hikayesi</h2><p className="text-gray-700 whitespace-pre-line">{seller.story}</p></section>}
      <section><h2 className="text-xl font-semibold mb-3">Ürünleri</h2><div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">{items.map(p=>(<a key={p.id} href={"#/products/"+p.id} onClick={(e)=>{e.preventDefault(); navTo("/products/"+p.id);}} className="border rounded-lg overflow-hidden hover:shadow-sm"><img src={(p.imageUrls&&p.imageUrls[0])||'https://via.placeholder.com/400'} className="w-full h-48 object-cover"/><div className="p-2"><p className="font-medium line-clamp-2">{p.productName||p.id}</p><p className="text-sm text-gray-500">{p.price ? (p.price+" ₺") : ""}</p></div></a>))}</div></section>
    </div>); }
  function onHash(){ const h = hashPath(); if (h.startsWith("/seller/")){ const id = decodeURIComponent(h.slice(8)); mask(true); root.render(<SellerPage sellerId={id} />); showing=true; window.scrollTo(0,0); return; } if (showing){ root.render(null); mask(false); showing=false; } }
  window.addEventListener("hashchange", onHash); window.addEventListener("load", onHash);
})();

// product page enhancements (only if product id resolves)
function mountProduct(){
  (async()=>{
    const pid = await resolveProductId();
    if(!pid) return; // sadece ürün sayfasında
    const prod = await fetchProduct(pid);
    const sellerId = prod?.sellerId || prod?.seller || prod?.ownerId || null;
    const sellerName = prod?.sellerName || null;
    const seller = await fetchUserByIdOrName(sellerId, sellerName);

    // seller line
    const titleEl = document.querySelector("h1, .product-title");
    if (titleEl && !document.getElementById("k-seller-line")){
      const line = document.createElement("div"); line.id="k-seller-line"; line.className="flex items-center gap-2 text-sm text-gray-600 mt-2";
      const a = document.createElement("a"); a.href = "#/seller/"+(seller?.id||sellerId||"unknown"); a.className="underline hover:text-black";
      a.textContent = seller?.displayName || seller?.name || prod?.sellerName || "Satıcı";
      a.addEventListener("click",(e)=>{ e.preventDefault(); navTo("/seller/"+(seller?.id||sellerId||"unknown")); });
      line.appendChild(document.createTextNode("Satıcı: ")); line.appendChild(a);
      titleEl.parentElement.insertBefore(line, titleEl.nextSibling);
    }

    // unified media (square, video autoplay muted loop)
    const candidates = $$("img, video").map(el=>{ const r=el.getBoundingClientRect(); return {el,area:r.width*r.height}; }).filter(x=>x.area>5000);
    if (candidates.length){
      candidates.sort((a,b)=>b.area-a.area);
      let container = candidates[0].el.parentElement;
      if (container && container.children.length===1) container = container.parentElement || container;

      const origEl = candidates[0].el;
      const origType = origEl.tagName.toLowerCase()==="video"?"video":"image";
      const origSrc = origType==="video" ? (origEl.querySelector("source")?.src || origEl.currentSrc || origEl.src || "") : (origEl.src||"");

      let list = [];
      if (Array.isArray(prod?.imageUrls)) list = list.concat(prod.imageUrls.map(src=>({type:"image",src})));
      if (Array.isArray(prod?.videoUrls)) list = list.concat(prod.videoUrls.map(src=>({type:"video",src})));
      if (!list.length){
        const imgs = $$("img").filter(i=> i.width>120 && i.height>120).map(i=>({type:"image",src:i.src}));
        const vids = $$("video").map(v=>{ const s=v.querySelector("source")?.src||v.currentSrc||v.src; return s ? {type:"video",src:s}:null; }).filter(Boolean);
        list = imgs.concat(vids);
      }
      if (origSrc){
        const exist = list.find(m => m.src===origSrc && m.type===origType);
        if (!exist) list.unshift({type:origType, src:origSrc}); else list = [exist, ...list.filter(m => !(m.src===origSrc && m.type===origType))];
      }
      const seen = new Set(); list = list.filter(m=>{ const k=m.type+"|"+m.src; if(seen.has(k)) return false; seen.add(k); return true; });
      if (!list.length) return;

      const mount = document.createElement("div"); mount.id="k-media-gallery";
      while (container.firstChild) container.removeChild(container.firstChild);
      container.appendChild(mount);

      const R = ReactDOM.createRoot(mount);
      function Media(){
        const [i,setI] = React.useState(0);
        const item = list[i];
        const Thumb = ({m,active,onClick}) => m.type==="image"
          ? <button onClick={onClick} className={""+(active?"active ":"")}><img src={m.src}/></button>
          : <button onClick={onClick} className={"vid "+(active?"active ":"")}>VIDEO ▷</button>;
        return (<div>
          <div className="k-stage">
            {item.type==="image" ? <img src={item.src}/> : <video key={item.src} src={item.src} autoplay muted loop playsInline disablePictureInPicture controlsList="nodownload noplaybackrate"></video>}
          </div>
          {list.length>1 && (<div className="k-thumbs mt-3">{list.map((m,idx)=>(<Thumb key={idx} m={m} active={idx===i} onClick={()=>setI(idx)} />))}</div>)}
        </div>);
      }
      R.render(<Media />);
    }

    // bottom sections (seller's others first, then similar) — already under product
    const main = document.querySelector("main") || document.body;
    if (!document.getElementById("k-product-bottom")){
      const bottom = document.createElement("div"); bottom.id="k-product-bottom"; bottom.className="max-w-6xl mx-auto px-4 md:px-6";
      main.appendChild(bottom);
      const RB = ReactDOM.createRoot(bottom);
      function Bottom(){
        const [fromSeller,setFromSeller] = React.useState([]);
        const [similar,setSimilar]       = React.useState([]);
        React.useEffect(()=>{ (async()=>{
          const all = await fetchAllProducts();
          if (sellerId) setFromSeller(all.filter(p => (p.sellerId||p.seller||p.ownerId)===sellerId && p.id!==pid).slice(0,8));
          if (prod?.category){
            setSimilar(all.filter(p => (p.category||"") === (prod.category||"") && p.id!==pid).slice(0,8));
          } else {
            setSimilar(all.filter(p => p.id!==pid).slice(0,8));
          }
        })(); }, []);
        return (<div className="mt-10 space-y-10">
          {(seller?.story || prod?.productStory) && (<section className="border rounded-2xl p-4 md:p-6"><h3 className="text-lg font-semibold mb-2">Satıcının Hikayesi</h3><p className="text-gray-700 whitespace-pre-line">{seller?.story || prod?.productStory}</p></section>)}
          {fromSeller.length>0 && (<section><div className="flex items-center justify-between mb-3"><h3 className="text-lg font-semibold">Satıcının Diğer Ürünleri</h3><a className="text-sm underline" href={"#/seller/"+(seller?.id||sellerId||"unknown")} onClick={(e)=>{e.preventDefault(); navTo("/seller/"+(seller?.id||sellerId||"unknown"));}}>Tümünü Gör</a></div>
            <div className="grid grid-cols-2 md:grid-cols-4 gap-4">{fromSeller.map(p=>(<a key={p.id} href={"#/products/"+p.id} onClick={(e)=>{e.preventDefault(); navTo("/products/"+p.id);}} className="border rounded-lg overflow-hidden"><img src={(p.imageUrls&&p.imageUrls[0])||'https://via.placeholder.com/400'} className="w-full h-40 object-cover"/><div className="p-2"><p className="font-medium line-clamp-2">{p.productName||p.id}</p><p className="text-sm text-gray-500">{p.price ? (p.price+" ₺") : ""}</p></div></a>))}</div></section>)}
          {similar.length>0 && (<section><h3 className="text-lg font-semibold mb-3">Benzer Ürünler</h3><div className="grid grid-cols-2 md:grid-cols-4 gap-4">{similar.map(p=>(<a key={p.id} href={"#/products/"+p.id} onClick={(e)=>{e.preventDefault(); navTo("/products/"+p.id);}} className="border rounded-lg overflow-hidden"><img src={(p.imageUrls&&p.imageUrls[0])||'https://via.placeholder.com/400'} className="w-full h-40 object-cover"/><div className="p-2"><p className="font-medium line-clamp-2">{p.productName||p.id}</p><p className="text-sm text-gray-500">{p.price ? (p.price+" ₺") : ""}</p></div></a>))}</div></section>)}
        </div>);
      }
      RB.render(<Bottom />);
    }

    // wishlist sync for product + header
    syncFavoriteUI();
  })();
}
window.addEventListener("load", mountProduct);
window.addEventListener("hashchange", ()=> setTimeout(mountProduct,0));

/* CART OVERLAY
   - Açılması yalnızca sepet ikonuna tıklayınca
   - 'Sepete Ekle' tıklandığında overlay açma, sadece butonda qty animasyonu
*/
const $overlay = document.getElementById("k-cart-overlay");
const $items   = document.getElementById("k-cart-items");
const $total   = document.getElementById("k-total");
$("#k-cart-close")?.addEventListener("click", ()=> closeCartOverlay());
$overlay?.addEventListener("click",(e)=>{ if(e.target===$overlay) closeCartOverlay(); });
function openCartOverlay(){ if(!$overlay) return; $overlay.style.display="block"; syncCartBadges(); }
function closeCartOverlay(){ if(!$overlay) return; $overlay.style.display="none"; }
function addLine(title, price){
  const row = document.createElement("div"); row.className="flex items-center justify-between gap-3";
  row.innerHTML = '<div class="flex-1">'+(title||"Ürün")+'</div><div>'+ (price||"0") +' ₺</div>';
  $items.appendChild(row); recalcTotal(); syncCartBadges();
}
function recalcTotal(){ let sum=0; Array.from($items.children).forEach(r=>{ const t=r.lastChild.textContent.replace(/[^\d]/g,""); sum += Number(t||0); }); $total.textContent = sum + " ₺"; }
function syncCartBadges(){ const c=($items?.children?.length||0); const d=$("#k-cart-badge"); if(d){ d.style.display = c>0 ? "inline-block" : "none"; d.textContent=String(c); } const m=$("#k-cart-badge-mobile"); if(m){ m.style.display = c>0 ? "inline-block" : "none"; m.textContent=String(c);} }

// header desktop: rightmost -> cart (and click opens overlay)
(function(){
  const header = document.querySelector("header") || document;
  const iconCandidates = $$("a,button", header).filter(n => /favori|sepet|cart|basket|wishlist|login|account|hesap/i.test(n.textContent||"") || n.querySelector("svg"));
  if (iconCandidates.length){
    const rightmost = iconCandidates[iconCandidates.length-1];
    rightmost.style.position = "relative";
    rightmost.innerHTML = '<span class="relative inline-block"><svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 6h15l-1.5 9h-12z"/><circle cx="9" cy="20" r="1.5"/><circle cx="18" cy="20" r="1.5"/><path d="M6 6L5 3H2"/></svg><span id="k-cart-badge" class="k-cart-badge">0</span></span>';
    rightmost.addEventListener("click", (e)=>{ e.preventDefault(); openCartOverlay(); });
  }
})();

// mobile bottom bar last icon -> cart + badge
(function(){
  const bar = document.querySelector(".mobile-tabbar, .bottom-nav, nav[role='tablist'], footer");
  if (!bar) return;
  const lastBtn = $$("a,button", bar).slice(-1)[0]; if(!lastBtn) return;
  lastBtn.innerHTML = '<span class="k-mobile-cart"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 6h15l-1.5 9h-12z"/><circle cx="9" cy="20" r="1.5"/><circle cx="18" cy="20" r="1.5"/><path d="M6 6L5 3H2"/></svg><span class="k-cart-icon-badge" id="k-cart-badge-mobile">0</span></span><div class="text-xs mt-1">Sepetim</div>';
  lastBtn.addEventListener("click",(e)=>{ e.preventDefault(); openCartOverlay(); });
  syncCartBadges();
})();

// Add-to-cart button -> only qty animation (no overlay)
document.addEventListener("click",(e)=>{
  const el = e.target.closest(".add-to-cart, [data-add-to-cart]");
  if (!el) return;
  e.preventDefault();
  // create qty pill if not exists
  if (!el.__qty){
    const pill = document.createElement("span");
    pill.className = "k-qty k-pulse";
    pill.innerHTML = '<button aria-label="Azalt">-</button><span class="count">1</span><button aria-label="Arttır">+</button>';
    el.__qty = { pill, count: 1 };
    el.innerHTML = ""; el.appendChild(pill);
    setTimeout(()=> pill.classList.remove("k-pulse"), 650);
  } else {
    // increment
    el.__qty.count += 1;
    el.__qty.pill.querySelector(".count").textContent = String(el.__qty.count);
    el.__qty.pill.classList.add("k-pulse"); setTimeout(()=>el.__qty.pill.classList.remove("k-pulse"), 650);
  }
  addLine((document.querySelector("h1, .product-title")||{}).textContent||"Ürün", 7999);
});
// handle +/-
document.addEventListener("click",(e)=>{
  const dec = e.target.closest(".k-qty button:first-child");
  const inc = e.target.closest(".k-qty button:last-child");
  if (!dec && !inc) return;
  const pill = e.target.closest(".k-qty"); const rootBtn = pill?.parentElement;
  if (!pill || !rootBtn || !rootBtn.__qty) return;
  if (dec){ rootBtn.__qty.count = Math.max(0, rootBtn.__qty.count - 1); }
  if (inc){ rootBtn.__qty.count += 1; }
  pill.querySelector(".count").textContent = String(rootBtn.__qty.count);
  pill.classList.add("k-pulse"); setTimeout(()=>pill.classList.remove("k-pulse"), 650);
});
</script>
<!-- === /Kadraj Enhancements Pack v14 === -->

</body>
</html>

outer + guarante
